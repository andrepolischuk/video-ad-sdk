!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(self,(function(){return function(){var e={296:function(e,t,n){var i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,l=d||c||Function("return this")(),h=Object.prototype.toString,u=Math.max,p=Math.min,m=function(){return l.Date.now()};function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function f(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=o.test(e);return n||s.test(e)?a(e.slice(2),n?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var i,r,o,s,a,d,c=0,l=!1,h=!1,E=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function w(t){var n=i,o=r;return i=r=void 0,c=t,s=e.apply(o,n)}function g(e){var n=e-d;return void 0===d||n>=t||n<0||h&&e-c>=o}function y(){var e=m();if(g(e))return A(e);a=setTimeout(y,function(e){var n=t-(e-d);return h?p(n,o-(e-c)):n}(e))}function A(e){return a=void 0,E&&i?w(e):(i=r=void 0,s)}function b(){var e=m(),n=g(e);if(i=arguments,r=this,d=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(y,t),l?w(e):s}(d);if(h)return a=setTimeout(y,t),w(d)}return void 0===a&&(a=setTimeout(y,t)),s}return t=f(t)||0,v(n)&&(l=!!n.leading,o=(h="maxWait"in n)?u(f(n.maxWait)||0,t):o,E="trailing"in n?!!n.trailing:E),b.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=d=r=a=void 0},b.flush=function(){return void 0===a?s:A(m())},b}},722:function(e,t){"use strict";var n=[new RegExp("^<h3[^>]*>This page contains the following errors:</h3><div[^>]*>(.+?)\n?</div>"),new RegExp("^(.+)\n")];t.failOnParseError=function(e){return function(e){var t;if(null===e)throw new Error("Parse error");var i=function(e){return"parsererror"===e.documentElement.tagName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI?e.documentElement:("xml"===e.documentElement.tagName||"html"===e.documentElement.tagName)&&e.documentElement.childNodes&&e.documentElement.childNodes.length>0&&"parsererror"===e.documentElement.childNodes[0].nodeName?e.documentElement.childNodes[0]:"html"===e.documentElement.tagName&&e.documentElement.childNodes&&e.documentElement.childNodes.length>0&&"body"===e.documentElement.childNodes[0].nodeName&&e.documentElement.childNodes[0].childNodes&&e.documentElement.childNodes[0].childNodes.length&&"parsererror"===e.documentElement.childNodes[0].childNodes[0].nodeName?e.documentElement.childNodes[0].childNodes[0]:void 0}(e);if(void 0!==i)throw t=function(e){var t,i,r,o,s=(t=e,i=new XMLSerializer,Array.prototype.map.call(t.childNodes,(function(e){return i.serializeToString(e)})).join(""));for(r=0;r<n.length;r++)if(o=n[r].exec(s))return o[1]}(i)||"Parse error",new Error(t)}(e),e}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){"use strict";var e;n.r(i),function(e){e[e.VAST_XML_PARSING_ERROR=100]="VAST_XML_PARSING_ERROR",e[e.VAST_SCHEMA_VALIDATION_ERROR=101]="VAST_SCHEMA_VALIDATION_ERROR",e[e.VAST_UNSUPPORTED_VERSION=102]="VAST_UNSUPPORTED_VERSION",e[e.VAST_UNEXPECTED_AD_TYPE=200]="VAST_UNEXPECTED_AD_TYPE",e[e.VAST_UNEXPECTED_LINEARITY=201]="VAST_UNEXPECTED_LINEARITY",e[e.VAST_UNEXPECTED_DURATION_ERROR=202]="VAST_UNEXPECTED_DURATION_ERROR",e[e.VAST_UNEXPECTED_MEDIA_FILE=203]="VAST_UNEXPECTED_MEDIA_FILE",e[e.VAST_WRAPPER_ERROR=300]="VAST_WRAPPER_ERROR",e[e.VAST_LOAD_TIMEOUT=301]="VAST_LOAD_TIMEOUT",e[e.VAST_TOO_MANY_REDIRECTS=302]="VAST_TOO_MANY_REDIRECTS",e[e.VAST_NO_ADS_AFTER_WRAPPER=303]="VAST_NO_ADS_AFTER_WRAPPER",e[e.VIDEO_PLAY_ERROR=400]="VIDEO_PLAY_ERROR",e[e.VAST_MEDIA_FILE_NOT_FOUND=401]="VAST_MEDIA_FILE_NOT_FOUND",e[e.VAST_MEDIA_LOAD_TIMEOUT=402]="VAST_MEDIA_LOAD_TIMEOUT",e[e.VAST_LINEAR_ASSET_MISMATCH=403]="VAST_LINEAR_ASSET_MISMATCH",e[e.VAST_PROBLEM_DISPLAYING_MEDIA_FILE=405]="VAST_PROBLEM_DISPLAYING_MEDIA_FILE",e[e.VAST_NONLINEAR_PLAYING_FAILED=500]="VAST_NONLINEAR_PLAYING_FAILED",e[e.VAST_NONLINEAR_DIMENSIONS_ERROR=501]="VAST_NONLINEAR_DIMENSIONS_ERROR",e[e.VAST_NONLINEAR_LOADING_FAILED=502]="VAST_NONLINEAR_LOADING_FAILED",e[e.VAST_NONLINEAR_ASSET_MISMATCH=503]="VAST_NONLINEAR_ASSET_MISMATCH",e[e.UNKNOWN_ERROR=900]="UNKNOWN_ERROR",e[e.VPAID_ERROR=901]="VPAID_ERROR"}(e||(e={}));const t=t=>Object.values(e).includes(t),r="complete",o="clickThrough",s="error",a="firstQuartile",d="impression",c="viewable",l="notViewable",h="viewUndetermined",u="midpoint",p="mute",m="pause",v="playerCollapse",f="exitFullscreen",E="playerExpand",w="fullscreen",g="progress",y="resume",A="rewind",b="skip",T="start",C="thirdQuartile",I="unmute",O="iconClick",_="iconView",S="closeLinear",R="creativeView",N={clickThrough:o,closeLinear:S,complete:r,creativeView:R,error:s,exitFullscreen:f,firstQuartile:a,fullscreen:w,iconClick:O,iconView:_,impression:d,midpoint:u,mute:p,notViewable:l,otherAdInteraction:"otherAdInteraction",pause:m,playerCollapse:v,playerExpand:E,progress:g,resume:y,rewind:A,skip:b,start:T,thirdQuartile:C,timeSpentViewing:"timeSpentViewing",unmute:I,viewable:c,viewUndetermined:h},L="acceptInvitation",k="adCollapse",V="close",P={acceptInvitation:L,adCollapse:k,close:V};var x,M=n(722);!function(e){e.CDATA="cdata",e.DOCUMENT="document",e.ELEMENT="element",e.TEXT="text"}(x||(x={}));const D={1:x.ELEMENT,3:x.TEXT,4:x.TEXT},F={9:x.DOCUMENT},U=e=>{const t=(e=>{var t;const n=null!==(t=D[e.nodeType])&&void 0!==t?t:F[e.nodeType];if(!n)throw new Error("Unsupported element type");return n})(e),n={type:t};if(e instanceof Element){const t=(e=>0===e.attributes.length?void 0:Object.fromEntries(Array.from(e.attributes).map((e=>{var t;return[e.nodeName,null!==(t=e.nodeValue)&&void 0!==t?t:void 0]}))))(e);t&&(n.attributes=t),n.name=e.nodeName.toLowerCase()}else(e instanceof Text||e instanceof CDATASection)&&(n.text=(e=>{var t;return null===(t=e.nodeValue)||void 0===t?void 0:t.replace("<![CDATA[","").replace("]]>","").trim()})(e));const i=(e=>{var t,n;if(!e.hasChildNodes())return;const i=Array.from(e.childNodes).filter((e=>Object.keys(D).map(Number).includes(e.nodeType))),r=[];for(const e of i){const i=U(e);e instanceof Text&&!((null!==(n=null===(t=i.text)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0)||r.push(i)}return r})(e);return i&&(n.elements=i),n},j=e=>{var t;return null!==(t=e.elements)&&void 0!==t?t:[]},$=(e,t)=>j(e).find((({name:e=""})=>e.toUpperCase()===t.toUpperCase())),B=(e,t)=>"string"==typeof t?((e,t)=>j(e).filter((({name:e=""})=>e.toUpperCase()===t.toUpperCase())))(e,t):j(e),W=e=>j(e)[0],X=e=>{const t=e&&W(e);return t&&t.text},H=e=>{var t;return null!==(t=e.attributes)&&void 0!==t?t:{}},z=(e,t)=>H(e)[t],Y=new DOMParser,q=e=>{if("string"==typeof e){const t=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/,n=e.match(t);if(n){const[,e,t,i,,r]=n,o=60*Number(e)*60*1e3+60*Number(t)*1e3+1e3*Number(i)+(r?Number(r):0);if(!isNaN(o))return o}}},G=e=>(e=>/^\d+(\.\d+)?%$/g.test(e))(e)?e:q(e),Q=e=>$(e,"linear"),K=e=>{const t=W(e),n=t&&$(t,"creatives");return n&&B(n).find(Q)},J=e=>{const{event:t,offset:n}=H(e),i=X(e);return{event:t,offset:n&&G(n),uri:i}},Z=(e,t)=>{const n=e&&K(e),i=n&&$(n,"Linear"),r=i&&$(i,"TrackingEvents"),o=r&&B(r,"Tracking");if(o&&o.length>0){const e=o.map(J);if(!t)return e;const n=e.filter((({event:e})=>e===t));if(n.length>0)return n}},ee=e=>{const t=`${e}`.match(/\d+/g);return Number((null==t?void 0:t[0])||"")},te=e=>/\d+/.test(e)?ee(e):e,ne=e=>{const t=e&&K(e),n=t&&$(t,"linear"),i=n&&$(n,"Icons"),r=i&&B(i,"Icon");if(r&&r.length>0)return r.map((e=>Object.assign(Object.assign(Object.assign(Object.assign({},(e=>{const{duration:t,height:n,offset:i,program:r,pxratio:o,width:s,xPosition:a="right",yPosition:d="top"}=H(e);return{duration:t&&q(t)||void 0,height:n&&ee(n)||void 0,offset:i&&q(i)||void 0,program:r,pxratio:o&&parseInt(o,10)||void 0,width:s&&ee(s)||void 0,xPosition:a&&te(a),yPosition:d&&te(d)}})(e)),(e=>{const t=$(e,"StaticResource"),n=$(e,"HTMLResource"),i=$(e,"IFrameResource");return t?{staticResource:X(t)}:n?{htmlResource:X(n)}:i?{iFrameResource:X(i)}:{staticResource:X(e)}})(e)),(e=>{const t=B(e,"IconViewTracking").map((e=>X(e))).filter(Boolean);return 0===t.length?{}:{iconViewTracking:t}})(e)),(e=>{const t=$(e,"IconClicks"),n=t&&$(t,"IconClickThrough"),i=t&&B(t,"IconClickTracking").map((e=>X(e))).filter(Boolean);return{iconClickThrough:n&&X(n),iconClickTracking:i&&i.length>0?i:void 0}})(e))))},ie=e=>"string"==typeof e?"true"===e:Boolean(e),re=(e,t)=>{const n=z(e,"sequence"),i=z(t,"sequence"),r=n&&parseInt(n,10),o=i&&parseInt(i,10);return"string"!=typeof r||"string"!=typeof o?0:r<o?-1:r>o?1:0},oe=e=>{const t=e&&$(e,"VAST"),n=t&&B(t,"Ad");return n&&n.length>0?n:[]},se=e=>{const t=z(e,"sequence"),n=t&&parseInt(t,10);if("number"==typeof n&&!isNaN(n))return n},ae=e=>Boolean(se(e)),de=e=>{const t=oe(e);return Array.isArray(t)&&t.filter(ae).length>1},ce=e=>Boolean($(e||{},"Wrapper")),le=e=>{const t=$(e,"Wrapper"),n=t&&$(t,"VastAdTagUri");return n&&X(n)},he=e=>{const t=e&&W(e),n=t&&$(t,"ViewableImpression"),i=n&&B(n,"Viewable");if(i&&i.length>0)return i.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)},ue=e=>{const t=e&&K(e),n=t&&$(t,"UniversalAdId"),i=n&&X(n),r=t&&$(t,"Linear"),o=r&&$(r,"MediaFiles"),s=o&&B(o,"MediaFile");if(s&&s.length>0)return s.map((e=>{const t=X(e),{apiFramework:n,bitrate:r,codec:o,delivery:s,height:a,id:d,maintainAspectRatio:c,maxBitrate:l,minBitrate:h,scalable:u,type:p,width:m}=H(e);return{apiFramework:n,bitrate:r,codec:o,delivery:s,height:a,id:d,maintainAspectRatio:c,maxBitrate:l,minBitrate:h,scalable:u,src:t,type:p,universalAdId:i,width:m}}))},pe=e=>{let t=(e=>{const t=e&&K(e),n=t&&$(t,"Linear"),i=n&&$(n,"MediaFiles"),r=i&&B(i,"InteractiveCreativeFile");if(r&&r.length>0)return r.map((e=>{const{apiFramework:t,type:n}=H(e);return{apiFramework:t,src:X(e),type:n}}))})(e);if(t)return t;const n=ue(e);return n&&(t=n.filter((({apiFramework:e=""})=>"vpaid"===(null==e?void 0:e.toLowerCase()))).map((({apiFramework:e,src:t,type:n})=>({apiFramework:e,src:t,type:n}))),t.length>0)?t:void 0},me=e=>{const t=e&&K(e),n=t&&$(t,"Linear");return n&&$(n,"VideoClicks")},ve=e=>{const t=me(e),n=t&&$(t,"ClickThrough");return n&&X(n)},fe=e=>{const t=e&&K(e),n=t&&$(t,"Linear"),i=n&&z(n,"skipoffset");return i&&G(i)},Ee=(e,t)=>{const n=new Image;return n.src=((e,t={})=>{let n=e;const i=(e=>{const t={};return Object.keys(e).forEach((n=>{const{[n]:i}=e;t[n.toUpperCase()]=i})),t})(t);return i.CACHEBUSTING||(i.CACHEBUSTING=Math.round(1e10*Math.random())),i.TIMESTAMP||(i.TIMESTAMP=(new Date).toISOString()),Object.keys(i).forEach((e=>{const t=encodeURIComponent(i[e]);n=n.replace(new RegExp(`\\[${e}\\]`,"gm"),t)})),n})(e,t),n},we=(e,{errorCode:t,tracker:n=Ee})=>{e.forEach((({ad:e,parsedXML:i})=>{const r=e&&(e=>{const t=e&&W(e),n=t&&B(t,"Error");if(n&&n.length>0)return n.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)})(e)||(e=>{const t=e&&$(e,"VAST"),n=t&&B(t,"Error");if(n&&n.length>0)return n.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)})(i);null==r||r.forEach((e=>e&&n(e,{errorCode:t})))}))},ge=e=>(t,{data:n={},tracker:i=Ee})=>{t.forEach((({ad:t})=>{const r=t&&e(t);r&&(r&&"string"==typeof r?i(r,n):Array.isArray(r)&&r.map((({uri:e})=>e&&i(e,n))))}))},ye=(...e)=>t=>{const n=[];return e.length>0&&e.forEach((e=>{const i=e(t);Array.isArray(i)&&i.length>0&&n.push(...i.map((e=>({uri:e}))))})),n},Ae=e=>t=>Z(t,e),be={[o]:ge(ye((e=>{const t=e&&me(e),n=t&&B(t,"ClickTracking");if(n&&n.length>0)return n.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)}),(e=>{const t=me(e),n=t&&B(t,"CustomClick");if(n&&n.length>0)return n.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)}))),[S]:ge(Ae(S)),[r]:ge(Ae(r)),[R]:ge(Ae(R)),[s]:we,[f]:ge(Ae(f)),[a]:ge(Ae(a)),[w]:ge(Ae(w)),[O]:(e,{data:t={},tracker:n=Ee})=>{const{iconClickTracking:i}=t;if(Array.isArray(i))for(const e of i)n(e,Object.assign({},t))},[_]:(e,{data:t={},tracker:n=Ee})=>{const{iconViewTracking:i}=t;if(Array.isArray(i))for(const e of i)n(e,Object.assign({},t))},[d]:ge(ye((e=>{const t=e&&W(e),n=t&&B(t,"Impression");if(n&&n.length>0)return n.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)}))),[u]:ge(Ae(u)),[p]:ge(Ae(p)),[l]:ge(ye((e=>{const t=e&&W(e),n=t&&$(t,"ViewableImpression"),i=n&&B(n,"NotViewable");if(i&&i.length>0)return i.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)}))),[m]:ge(Ae(m)),[v]:ge(Ae(v)),[E]:ge(Ae(E)),[g]:(e,{data:t={},tracker:n=Ee})=>{const{progressUri:i}=t;i&&n(i,Object.assign({},t))},[y]:ge(Ae(y)),[A]:ge(Ae(A)),[b]:ge(Ae(b)),[T]:ge(Ae(T)),[C]:ge(Ae(C)),[I]:ge(Ae(I)),[c]:ge(ye(he)),[h]:ge(ye((e=>{const t=e&&W(e),n=t&&$(t,"ViewableImpression"),i=n&&B(n,"ViewUndetermined");if(i&&i.length>0)return i.map((e=>{var t;return null!==(t=X(e))&&void 0!==t?t:""})).filter(Boolean)})))},Te=e=>t=>((e,t)=>{const n=e&&K(e),i=n&&$(n,"NonLinearAds"),r=i&&$(i,"TrackingEvents"),o=r&&B(r,"Tracking");if(o&&o.length>0){const e=o.map((e=>{const{event:t}=H(e);return{event:t,uri:X(e)}}));if(!t)return e;const n=e.filter((({event:e})=>e===t));if(n.length>0)return n}})(t,e),Ce={[L]:ge(Te(L)),[k]:ge(Te(k)),[V]:ge(Te(V))},Ie=e=>e.contentDocument||e.contentWindow&&e.contentWindow.document,Oe="srcdoc"in document.createElement("iframe"),_e=()=>{const e=document.createElement("iframe");return e.setAttribute("sandbox","allow-forms allow-popups allow-scripts allow-same-origin"),e.setAttribute("loading","eager"),e.style.margin="0",e.style.padding="0",e.style.border="none",e.style.width="0",e.style.height="0",e.style.position="absolute",e};var Se;const Re=(e=>{let t=-1;return()=>"videoAdContainer_"+ ++t})(),Ne=Symbol("hidden");class Le{constructor(e,t){if(this[Se]={destroyed:!1,id:Re(),iframe:void 0,readyPromise:void 0},!(e instanceof Element))throw new TypeError("placeholder is not an Element");this.element=(()=>{const e=document.createElement("div");return e.classList.add("mol-video-ad-container"),e.style.width="100%",e.style.height="100%",e})(),this.isOriginalVideoElement=Boolean(t),t?this.videoElement=t:(this.videoElement=((e=document)=>{const t=e.createElement("video");return t.style.width="100%",t.style.height="100%",t})(),this.element.appendChild(this.videoElement)),e.appendChild(this.element)}async addScript(e,t={}){var n;if(this.isDestroyed())throw new Error("VideoAdContainer has been destroyed");let{iframe:i}=this[Ne];i||(i=await((e,t)=>new Promise(((n,i)=>{const r=((e,t)=>`<!DOCTYPE html>\n<html>\n  <head><meta charset='UTF-8'></head>\n  <body style='margin:0;padding:0'>\n  <script type='text/javascript'>window.parent.postMessage('${e}_ready', '${t}');<\/script>\n  </body>\n</html>`)(t,(()=>{const{origin:e,protocol:t,hostname:n,port:i}=window.location;return e||`${t}//${n}${i?`:${i}`:""}`})());let o=_e();try{o.src="about:blank",e.appendChild(o);const t=Ie(o);if(!t)throw new TypeError("iframe content document is not a Document");t.write(r)}catch(t){e.removeChild(o),Oe?(o=_e(),o.src="about:srcdoc",o.srcdoc=r,e.appendChild(o)):i(t)}const s=({data:e})=>{e===`${t}_ready`&&(window.removeEventListener("message",s),n(o))};window.addEventListener("message",s,!1)})))(this.element,this[Ne].id),this[Ne].iframe=i,this.executionContext=i.contentWindow);const r=null===(n=Ie(i))||void 0===n?void 0:n.body;return((e,{async:t=!1,defer:n=!1,type:i,placeholder:r}={})=>{if(!e)throw new TypeError('Missing required "src" parameter');return new Promise(((o,s)=>{const a=document.createElement("script");let d=r;a.type=null!=i?i:"text/javascript",a.async=t,a.defer=n,a.onerror=()=>s(new URIError(`The script ${e} is not accessible.`)),a.onload=()=>o(a),d||(d=document.currentScript?document.currentScript.parentNode:document.head),a.src=e,null==d||d.appendChild(a)}))})(e,Object.assign({placeholder:r},t))}addSlot(e,t){if(this.isDestroyed())throw new Error("VideoAdContainer has been destroyed");this.slotElement||(this.slotElement=((e,t,n)=>{const i=document.createElement("DIV");return Object.assign(i.style,{border:"0px",cursor:"pointer",height:`${n}px`,left:"0px",margin:"0px",padding:"0px",position:"absolute",top:"0px",width:`${t}px`}),e.appendChild(i),i})(this.element,e,t))}destroy(){const e=new Promise((e=>{setTimeout((()=>{var t;null===(t=this.element.parentNode)||void 0===t||t.removeChild(this.element),e()}),1e3)}));return this.element.style.zIndex="-9999",this[Ne].destroyed=!0,e}isDestroyed(){return this[Ne].destroyed}}Se=Ne;const ke={"3gp":"video/3gpp",avi:"video/x-msvideo",flv:"video/x-flv",m3u8:"application/x-mpegURL",m4v:"video/mp4",mov:"video/quicktime",mp4:"video/mp4",mpd:"application/dash+xml",ogv:"video/ogg",ts:"video/MP2T",webm:"video/webm",wmv:"video/x-ms-wmv"},Ve=(e,t)=>{const{src:n,type:i}=t;return e.canPlayType(i||(e=>{const t=e.match(/\.([^./?]+)(\?[^/]+)?$/i),n=t&&t[1];return n&&ke[n]||`video/${n}`})(n||""))},Pe=e=>{const t=Number(e.width)||0,n=Number(e.height)||0;return{aspectRatio:n?Math.floor(t/n*10)/10:0,height:n,width:t}},xe=(e,t)=>{const[n]=((e,t)=>{const n=Pe(t);return e.slice(0).sort(((e,t)=>{const i=Pe(e),r=Pe(t),o=Math.abs(n.width-i.width),s=Math.abs(n.width-r.width);return Math.abs(n.aspectRatio-i.aspectRatio)-Math.abs(n.aspectRatio-r.aspectRatio)||o-s}))})(e,t);return n},Me=(e,t,{getMediaFile:n=xe})=>{const{element:i,videoElement:r}=t,o=i.getBoundingClientRect(),s=ue(e),a=null==s?void 0:s.filter((e=>Ve(r,e)));return a&&n(a,o)},De=(e,t,n)=>{const i=(...r)=>(e.removeEventListener(t,i),n(...r));return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}},{progress:Fe}=N,Ue=(e,t)=>(...n)=>{try{e(...n)}catch(e){null==t||t.error(e)}},{fullscreen:je,exitFullscreen:$e,playerCollapse:Be,playerExpand:We}=N,{pause:Xe,resume:He}=N,{rewind:ze}=N,{skip:Ye}=N,qe=()=>{const e=document.createElement("button");return e.classList.add("mol-vast-skip-control"),e.type="button",e.innerHTML="skip",e.style.position="absolute",e.style.bottom="15px",e.style.right="15px",e},{error:Ge}=N,Qe="volumeChanged",Ke="finish",Je="adProgress",{complete:Ze,firstQuartile:et,midpoint:tt,start:nt,thirdQuartile:it}=N,rt=(e,t)=>100*e/t,ot=(e,t)=>rt(e,t)>=99,{mute:st,unmute:at}=N,dt=e=>e.muted||0===e.volume,{impression:ct,creativeView:lt}=N,ht=(e,t)=>{let n=String(e);for(;n.length<t;)n=`0${n}`;return n},ut=e=>{const t=Math.floor(e/36e5),n=Math.floor(e/6e4%60),i=Math.floor(e/1e3%60),r=e%1e3;return`${ht(t,2)}:${ht(n,2)}:${ht(i,2)}.${ht(r,3)}`},{progress:pt}=N,mt=e=>1e3*e,vt=({offset:e,uri:t})=>{const n="number"==typeof e||Boolean(e&&(e=>/^\d+(\.\d+)?%$/g.test(e)&&!isNaN(parseFloat(e)))(e)),i="string"==typeof t&&t.length>0;return n&&i},ft=(e,t)=>"number"==typeof e?e:parseFloat(e)/100*t,{clickThrough:Et}=N,wt=()=>{const e=document.createElement("a");return e.classList.add("mol-vast-clickthrough"),e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.left="0",e.style.top="0",e},gt=[({videoElement:e,element:t},n,{clickThroughUrl:i,pauseOnAdClick:r=!0,createClickControl:o=wt}={})=>{const s=t||e.parentNode,a=o(),d=!document.body.contains(a);return d&&s.appendChild(a),i&&a instanceof HTMLAnchorElement&&(a.href=i,a.target="_blank"),a.onclick=t=>{t.stopPropagation(),e.paused&&r?(t.preventDefault(),e.play()):(r&&e.pause(),n(Et))},()=>{d&&s.removeChild(a)}},({videoElement:t},n)=>{const i=()=>{var i;const r=null!==(i=t.error)&&void 0!==i?i:void 0;r&&Object.defineProperty(r,"code",{get:()=>e.VAST_PROBLEM_DISPLAYING_MEDIA_FILE}),n(Ge,r)};return t.addEventListener("error",i),()=>{t.removeEventListener("error",i)}},({videoElement:e},t)=>{const n=["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"];let i=!1;const r=()=>{(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null)===e?(i=!0,t(We),t(je)):i&&(i=!1,t(Be),t($e))};for(const e of n)document.addEventListener(e,r);return()=>{for(const e of n)document.removeEventListener(e,r)}},({videoElement:e},t)=>{let n=!1;const i=()=>{const{currentTime:r}=e;!n&&r>0&&(n=!0,t(ct),t(lt),e.removeEventListener("timeupdate",i))};return e.addEventListener("timeupdate",i),()=>{e.removeEventListener("timeupdate",i)}},({videoElement:e},t)=>{let n=!1,i=!0;const r=()=>{n?i&&(i=!1,t(He)):(n=!0,i=!1)},o=()=>{i||(i=!0,t(Xe))};return e.addEventListener("play",r),e.addEventListener("pause",o),()=>{e.removeEventListener("play",r),e.removeEventListener("pause",o)}},({videoElement:e},t,{progressEvents:n=[]}={})=>{const{duration:i}=e,r=mt(i);let o=0,s=mt(e.currentTime),a=n.filter(vt).map((({offset:e,uri:t})=>({offset:ft(e,r),uri:t})));const d=()=>{const{currentTime:n}=e,i=Math.abs(n-s);o+=mt(i),s=n;const{stillPending:r,toCall:c}=a.reduce(((e,t)=>{const{offset:n}=t;return"number"==typeof n&&o>=n?e.toCall.push(t):e.stillPending.push(t),e}),{stillPending:[],toCall:[]});a=r,c.forEach((({uri:e})=>{t(pt,{contentplayhead:ut(o),progressUri:e})})),0===a.length&&e.removeEventListener("timeupdate",d)};return a.length>0&&e.addEventListener("timeupdate",d),()=>{e.removeEventListener("timeupdate",d)}},({videoElement:e},t)=>{let{currentTime:n}=e;const i=()=>{const i=e.currentTime-n;i<0&&Math.abs(i)>=1&&t(ze),n=e.currentTime};return e.addEventListener("timeupdate",i),()=>{e.removeEventListener("timeupdate",i)}},(e,t,{skipoffset:n,createSkipControl:i=qe}={})=>{if(!n)return()=>null;let r;const{videoElement:o,element:s}=e,a=()=>{const e=1e3*o.currentTime;!r&&"number"==typeof n&&e>=n&&(r=i(),r.onclick=e=>{var n;return null===(n=e.stopPropagation)||void 0===n||n.call(e),t(Ye),!1},s.appendChild(r),o.removeEventListener("timeupdate",a))};return o.addEventListener("timeupdate",a),()=>{o.removeEventListener("timeupdate",a),r&&s.removeChild(r)}},({videoElement:e},t)=>{let n=!1,i=!1,r=!1,o=!1,s=!1;const a={start:{isFired:e=>!n&&e>0,callback:()=>{n=!0,t(nt)}},firstQuartile:{isFired:(e,t)=>!i&&((e,t)=>rt(e,t)>=25)(e,t),callback:()=>{i=!0,t(et)}},midpoint:{isFired:(e,t)=>!r&&((e,t)=>rt(e,t)>=50)(e,t),callback:()=>{r=!0,t(tt)}},thirdQuartile:{isFired:(e,t)=>!o&&((e,t)=>rt(e,t)>=75)(e,t),callback:()=>{o=!0,t(it)}},complete:{isFired:(e,t)=>!s&&ot(e,t),callback:()=>{s=!0,t(Ze)}}},d=()=>{const{duration:n}=e,{currentTime:i}=e;for(const e in a)if(a[e].isFired(i,n)){a[e].callback();break}t(Je)},c=()=>{const{duration:n}=e,{currentTime:i}=e;!s&&ot(i,n)&&(s=!0,t(Ze)),e.removeEventListener("ended",c),e.removeEventListener("timeupdate",d)};return e.addEventListener("timeupdate",d),e.addEventListener("ended",c),()=>{e.removeEventListener("timeupdate",d),e.removeEventListener("ended",c)}},({videoElement:e},t)=>{let n=dt(e);const i=()=>{t(Qe),n&&!dt(e)?t(at):!n&&dt(e)&&t(st),n=dt(e)};return e.addEventListener("volumechange",i),()=>{e.removeEventListener("volumechange",i)}}];class yt extends Error{constructor(e){super(e),this.name="AdUnitError",Object.setPrototypeOf(this,yt.prototype)}}var At=n(296),bt=n.n(At);const Tt=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,Ct=()=>{},It=["style","clientWidth","clientHeight"],Ot=Symbol("mutationHandlers"),_t=Symbol("mutationObserver"),St=Symbol("resizeHandlers"),Rt=Symbol("resizeElement"),Nt=(e,t,{threshold:n=20}={})=>{((e,t)=>{if(!(e instanceof Element))throw new TypeError("Target is not an Element node");if(!(t instanceof Function))throw new TypeError("Callback is not a function")})(e,t);const i=({style:e,clientHeight:t,clientWidth:n})=>[e.width,e.height,n,t].join(".");let r=i(e);const o=bt()((()=>{const n=i(e);n!==r&&(r=n,t())}),n),s=Tt?((e,t)=>{var n;if(!e[Ot]){e[Ot]=[];const t=()=>{var t;null===(t=e[Ot])||void 0===t||t.forEach((e=>e()))};e[_t]=((e,t)=>{const n=new Tt((e=>{for(let n=0;n<e.length;n++){const{attributeName:i}=e[n];i&&It.includes(i)&&t()}}));return n.observe(e,{attributes:!0,characterData:!1,childList:!0}),n})(e,t)}return null===(n=e[Ot])||void 0===n||n.push(t),()=>{var n,i,r;e[Ot]=null===(n=e[Ot])||void 0===n?void 0:n.filter((e=>e!==t)),0===(null===(i=e[Ot])||void 0===i?void 0:i.length)&&(null===(r=e[_t])||void 0===r||r.disconnect(),delete e[Ot],delete e[_t])}})(e,o):Ct,a=((e,t)=>{var n;if(!e[St]){e[St]=[];const t=()=>{var t;null===(t=e[St])||void 0===t||t.forEach((e=>e()))};e[Rt]=(e=>{const t=document.createElement("iframe");return t.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; border: 0; overflow: hidden; pointer-events: none; z-index: -1;"),t.setAttribute("type","text/html"),t.setAttribute("loading","eager"),t.onload=()=>{t.contentWindow&&t.contentWindow.addEventListener("resize",e)},t.src="about:blank",t})(t),"static"===getComputedStyle(e).position&&(e.style.position="relative"),e.appendChild(e[Rt])}return null===(n=e[St])||void 0===n||n.push(t),()=>{var n,i;e[St]=null===(n=e[St])||void 0===n?void 0:n.filter((e=>e!==t)),0===(null===(i=e[St])||void 0===i?void 0:i.length)&&(e.removeChild(e[Rt]),delete e[St],delete e[Rt])}})(e,o);return()=>{s(),a()}},{IntersectionObserver:Lt}=window,kt=()=>{},Vt=Symbol("intersectionHandlers"),Pt=Symbol("intersectionObserver");let xt=[],Mt=[];const Dt=(e,t,{threshold:n=100,viewabilityOffset:i=.4}={})=>{if(((e,t)=>{if(!(e instanceof Element))throw new TypeError("Target is not an Element node");if(!(t instanceof Function))throw new TypeError("Callback is not a function")})(e,t),!Lt)return t(void 0),kt;let r=!1;const o=bt()((n=>{n.forEach((n=>{if(n.target===e){const e=!document.hidden&&n.intersectionRatio>i;e!==r&&(r=e,t(e))}})),Mt=n}),n),s=((e,t)=>{var n,i;if(!e[Vt]){e[Vt]=[];const t=(t,n)=>{var i;null===(i=e[Vt])||void 0===i||i.forEach((e=>e(t,n)))},i={root:null,rootMargin:"0px",threshold:[...new Array(11)].map(((e,t)=>t/10))};e[Pt]=new Lt(t,i),null===(n=e[Pt])||void 0===n||n.observe(e)}return null===(i=e[Vt])||void 0===i||i.push(t),()=>{var n,i,r;e[Vt]=null===(n=e[Vt])||void 0===n?void 0:n.filter((e=>e!==t)),0===(null===(i=e[Vt])||void 0===i?void 0:i.length)&&(null===(r=e[Pt])||void 0===r||r.disconnect(),delete e[Vt],delete e[Pt])}})(e,o),a=((e,t)=>{const n=()=>{xt&&xt.forEach((e=>e()))};return xt.push(t),1===xt.length&&document.addEventListener("visibilitychange",n),()=>{xt=xt.filter((e=>e!==t)),0===xt.length&&document.removeEventListener("visibilitychange",n)}})(0,(()=>o(Mt)));return()=>{s(),a()}};class Ft{constructor(e){this.events={},this.logger=e||console}on(e,t){const{events:n}=this;return(n[e]||(n[e]=[])).push(t),this}removeListener(e,t){const{events:n}=this,i=n[e]||(n[e]=[]);return n[e]=i.filter((e=>e!==t&&e._!==t)),this}removeAllListeners(e){return e?delete this.events[e]:this.events={},this}once(e,t){const n=(...i)=>{this.removeListener(e,n),t(...i)};return n._=t,this.on(e,n)}emit(e,...t){const{events:n}=this,i=n[e]||(n[e]=[]),r=i.length>0;return i.forEach((e=>{try{e(...t)}catch(e){e instanceof Error&&this.logger.error(e,e.stack)}})),r}}const Ut=({staticResource:e,htmlResource:t,iFrameResource:n}={})=>e||t||n||void 0,jt="UNKNOWN",$t=e=>1===e.length?e[0]:(e=>{const t=window.devicePixelRatio||0;return e.slice(0).sort(((e,n)=>Math.abs(t-(e.pxratio||0))-Math.abs(t-(n.pxratio||0))))})(e)[0],Bt=e=>{const t=e.map((({ad:e})=>e)).filter(Boolean).reduce(((e,t)=>[...e,...ne(t)||[]]),[]);if(t.length>0){const e=(e=>((e,t)=>{const n={};return e.filter((e=>{const i=t(e);return!(!i||n.hasOwnProperty(i)||(n[i]=!0,0))}))})(e,Ut))(t);return(e=>{const t=(e=>e.reduce(((e,t)=>{var n,i;const r=null!==(n=t.program)&&void 0!==n?n:jt;return null!==(i=e[r])&&void 0!==i||(e[r]=[]),e[r].push(t),e}),{}))(e);return Object.keys(t).reduce(((e,n)=>n===jt?[...e,...t[jt]]:[...e,$t(t[n])]),[])})(e)}},Wt=(e,t)=>{let n,i,r=!0;const o=new Promise(((e,t)=>{n=e,i=t})),s=De(e,t,((...e)=>{r=!1,n(e)}));return{cancel:()=>{r&&(r=!1,s(),i(new Error("waitFor was canceled")))},promise:o}};class Xt extends Error{constructor(e){super(e),this.name="FetchError",Object.setPrototypeOf(this,Xt.prototype)}}const Ht=document.createElement("div"),zt=()=>{},Yt=(e,{document:t,placeholder:n})=>new Promise(((i,r)=>{try{const o=((e,t)=>{const{staticResource:n,htmlResource:i,iFrameResource:r}=t;return n?((e,{document:t,data:n})=>{const{height:i,width:r}=n,o=t.createElement("img");return r&&(o.width=r),i&&(o.height=i),o.src=e,o})(n,{data:t,document:e}):i?((e,{document:t,data:n})=>{const{height:i,width:r}=n,o=t.createElement("div");return r&&(o.style.width=`${r}px`),i&&(o.style.height=`${i}px`),(async e=>{const t=await fetch(e),n=t.headers.get("Content-Type");if(t.status>=400){const e=new Xt(t.statusText);throw e.response=t,e}if(!n||!(e=>{const t=e.toLowerCase();return["text/plain","text/html"].some((e=>t.includes(e)))})(n)){const e=new Xt(`fetchHtml error, invalid Content-Type ${n}`);throw e.response=t,e}return t.text()})(e).then((e=>{o.innerHTML=e,o.dispatchEvent(new CustomEvent("load"))})).catch((()=>{o.dispatchEvent(new CustomEvent("error"))})),o})(i,{data:t,document:e}):r?((e,{document:t,data:n})=>{const{height:i,width:r}=n,o=t.createElement("iframe");return o.setAttribute("sandbox","allow-forms allow-popups allow-scripts"),o.setAttribute("loading","eager"),r&&(o.width=r.toString()),i&&(o.height=i.toString()),o.src=e,o.frameBorder="0",o.style.border="none",o})(r,{data:t,document:e}):Ht})(t,e),s=Wt(o,"error"),a=Wt(o,"load"),d=()=>{n.contains(o)&&(n.removeChild(o),o.style.zIndex="0")};s.promise.then((()=>{a.cancel(),d(),r(new Error("Error loading resource"))})).catch(zt),a.promise.then((()=>{s.cancel(),d(),i(o)})).catch(zt),o.style.zIndex="-9999",n.appendChild(o)}catch(e){r(e)}})),qt=({height:e,width:t})=>e*t,Gt=({left:e,width:t})=>e+t,Qt=({left:e})=>e,Kt=({top:e})=>e,Jt=({top:e,height:t})=>e+t,Zt=(e,t)=>{const n=((e,t)=>{const{drawnIcons:n,placeholder:i}=t,r=qt(i.getBoundingClientRect());return qt(e)+n.reduce(((e,t)=>{const{width:n,height:i}=t;return n&&i?e+qt({width:n,height:i}):e}),0)<=.35*r})(e,t),i=((e,{placeholder:t})=>{const n=t.getBoundingClientRect();return e.left>=0&&e.left+e.width<=n.width&&e.top>=0&&e.top+e.height<=n.height})(e,t),r=((e,{drawnIcons:t})=>!t.some((t=>((e,t)=>Qt(e)<=Gt(t)&&Gt(e)>=Qt(t)&&Jt(e)>=Kt(t)&&Kt(e)<=Jt(t))(e,t))))(e,t);return n&&i&&r},en=()=>{},tn=async(e,{onIconClick:t,videoAdContainer:n,logger:i=console})=>{const{element:r,videoElement:o}=n,s=[],{iconsToShow:a,otherIcons:d}=e.reduce(((e,t)=>(((e,t)=>{const n=1e3*t.currentTime,i=1e3*t.duration,r="string"==typeof e.offset?parseInt(e.offset,10):e.offset||0,o=e.duration||i;return r<=n&&n-r<=o})(t,o)?e.iconsToShow.push(t):e.otherIcons.push(t),e)),{iconsToShow:[],otherIcons:[]});return d.forEach((({element:e})=>{var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)})),await a.reduce((async(e,n)=>{try{await e;const i=await(async(e,t)=>{var n;const{placeholder:i}=t,r=await(async(e,t)=>{if(!e.element){const n=await Yt(e,t);(n instanceof HTMLIFrameElement||n instanceof HTMLImageElement)&&(n.width="100%",n.height="100%"),n.style.height="100%",n.style.width="100%",e.element=((e,t,{onIconClick:n=en}={})=>{const i=document.createElement("a");return t.iconClickThrough&&(i.href=t.iconClickThrough,i.target="_blank"),t.iFrameResource&&(e.style.pointerEvents="none"),i.onclick=e=>{void 0!==Event.prototype.stopPropagation&&e.stopPropagation(),n(t)},i.appendChild(e),i})(n,e,t)}return e.element})(e,t),o=((e,t,{drawnIcons:n,placeholder:i})=>{const{signature:r}=e,o=t.getBoundingClientRect(),s=i.getBoundingClientRect(),a=e.width||o.width,d=e.height||o.height,c=e.xPosition||"right",l=e.yPosition||"top";let h,u;if((e=>!["left","right"].includes(String(e).toLowerCase()))(c))h=c;else{const e=n.filter((e=>e.xPosition===c&&e.yPosition===l));h=((e,t,n,i)=>{const r=n.reduce(((e,t)=>e+(t.width?t.width+1:0)),0);return"left"===e?r:i-r-t})(c,a,e,s.width)}var p,m,v;(e=>!["top","bottom"].includes(String(e).toLowerCase()))(l)?u=l:(p=l,m=d,v=s.height,u="top"===p?0:v-m);const f=`${h}-${u}_${a}x${d}`;return Object.assign(e,{height:d,left:h,signature:f,top:u,updated:r!==f,width:a})})(e,r,t);if(!Zt(o,t))throw null===(n=r.parentNode)||void 0===n||n.removeChild(r),new Error("Icon can't be rendered");return r.parentNode&&!o.updated||i.appendChild(((e,t)=>{const{height:n,width:i,left:r,top:o,yPosition:s}=t;return e.style.position="absolute",e.style.left=`${r}px`,"bottom"===s?e.style.bottom="0":e.style.top=`${o}px`,e.style.height=`${n}px`,e.style.width=`${i}px`,e})(r,o)),o})(n,{document:document,drawnIcons:s,onIconClick:t,placeholder:r});s.push(i)}catch(e){i.log(e)}}),Promise.resolve()),s};const nn=Symbol("firstRenderPending"),rn=()=>{},on=(e,t)=>{var{videoAdContainer:n,onIconView:i=rn,onIconClick:r=rn}=t,o=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["videoAdContainer","onIconView","onIconClick"]);const{videoElement:s,element:a}=n;return e.forEach((e=>{e[nn]=!0})),{drawIcons:async()=>{const t=await tn(e,Object.assign({onIconClick:r,videoAdContainer:n},o));a.dispatchEvent(new CustomEvent("iconsDrawn")),t.forEach((e=>{e[nn]&&(i(e),e[nn]=!1)}))},hasPendingIconRedraws:()=>((e,t)=>{const n=1e3*t.currentTime,i=1e3*t.duration,r=e.filter((e=>!e.offset||e.offset<n)),o=e.filter((e=>e.duration&&e.duration<i));return r.length>0||o.length>0})(e,s),removeIcons:()=>(e=>e.filter((({element:e})=>Boolean(null==e?void 0:e.parentNode))).forEach((({element:e})=>{var t;return null===(t=null==e?void 0:e.parentNode)||void 0===t?void 0:t.removeChild(e)})))(e)}},sn=(e,t)=>{const{screen:n}=window;return e+100>n.width&&t+100>n.height?"fullscreen":e<400?"thumbnail":"normal"};var an,dn;const{start:cn,viewable:ln,notViewable:hn,viewUndetermined:un,iconClick:pn,iconView:mn}=N,vn=Symbol("_private"),fn=Symbol("_protected");class En extends Ft{constructor(e,t,{viewability:n=!1,responsive:i=!1,logger:r=console,pauseOnAdClick:o=!0}={}){super(r),this[an]={addIcons:()=>{if(!this.icons)return;const{drawIcons:e,hasPendingIconRedraws:t,removeIcons:n}=on(this.icons,{logger:this.logger,onIconClick:e=>this.emit(pn,{adUnit:this,data:e,type:pn}),onIconView:e=>this.emit(mn,{adUnit:this,data:e,type:mn}),videoAdContainer:this.videoAdContainer});this[fn].drawIcons=e,this[fn].removeIcons=n,this[fn].hasPendingIconRedraws=t,this[fn].onFinishCallbacks.push(n)},setupViewableImpression:()=>{let e;const t=Dt(this.videoAdContainer.element,(t=>{this.isFinished()||this[fn].viewable||("boolean"==typeof t?t?e=window.setTimeout(this[vn].handleViewableImpression,2e3,ln):clearTimeout(e):this[vn].handleViewableImpression(un))}),{viewabilityOffset:.5});this[fn].onFinishCallbacks.push((()=>{t(),clearTimeout(e),this[fn].viewable||this[vn].handleViewableImpression(hn)}))},handleViewableImpression:e=>{this[fn].viewable=Boolean(e),this.emit(e,{adUnit:this,type:e})},setupViewability:()=>{const e=Dt(this.videoAdContainer.element,(e=>{this.isFinished()||"boolean"==typeof e&&(e?this.resume():this.pause())}));this[fn].onFinishCallbacks.push(e)},setupResponsive:()=>{const{element:e}=this.videoAdContainer;this[fn].size={height:e.clientHeight,viewmode:sn(e.clientWidth,e.clientHeight),width:e.clientWidth};const t=Nt(e,(()=>{if(this.isFinished())return;const t=this[fn].size,n=e.clientHeight,i=e.clientWidth;n===(null==t?void 0:t.height)&&i===(null==t?void 0:t.width)||this.resize(i,n,sn(i,n))}));this[fn].onFinishCallbacks.push(t)}},this[dn]={finished:!1,started:!1,viewable:!1,onErrorCallbacks:[],onFinishCallbacks:[],finish:()=>{this.isFinished()||(this[fn].finished=!0,this[fn].onFinishCallbacks.forEach((e=>e())),this.emit(Ke,{adUnit:this,type:Ke}))},throwIfCalled:()=>{throw new Error("VideoAdUnit method must be implemented on child class")},throwIfFinished:()=>{if(this.isFinished())throw new Error("VideoAdUnit is finished")}},this.vastChain=e,this.videoAdContainer=t,this.icons=Bt(e),this.pauseOnAdClick=o,this[fn].onFinishCallbacks.push((e=>{let t=0,n=0;const i=()=>{e.duration-t>3&&(e.pause(),e.play(),e.currentTime=t)},r=()=>{const{currentTime:i}=e;Math.abs(i-t)>3?(n+=1,n>=2&&e.pause(),e.currentTime=t):t=i};return e.addEventListener("timeupdate",r),e.addEventListener("ended",i),()=>{e.removeEventListener("timeupdate",r),e.removeEventListener("ended",i)}})(this.videoAdContainer.videoElement)),this[vn].addIcons(),e.some((({ad:e})=>e&&he(e)))&&this.once(cn,this[vn].setupViewableImpression),n&&this.once(cn,this[vn].setupViewability),i&&this.once(cn,this[vn].setupResponsive)}start(){this[fn].throwIfCalled()}resume(){this[fn].throwIfCalled()}pause(){this[fn].throwIfCalled()}skip(){this[fn].throwIfCalled()}setVolume(e){this[fn].throwIfCalled()}getVolume(){this[fn].throwIfCalled()}cancel(){this[fn].throwIfCalled()}duration(){this[fn].throwIfCalled()}paused(){this[fn].throwIfCalled()}currentTime(){this[fn].throwIfCalled()}onFinish(e){if("function"!=typeof e)throw new TypeError("Expected a callback function");this[fn].onFinishCallbacks.push(Ue(e,this.logger))}onError(e){if("function"!=typeof e)throw new TypeError("Expected a callback function");this[fn].onErrorCallbacks.push(Ue(e,this.logger))}isFinished(){return this[fn].finished}isStarted(){return this[fn].started}async resize(e,t,n){var i,r,o,s;this[fn].size={height:t,viewmode:n,width:e},this.isStarted()&&!this.isFinished()&&this.icons&&(await(null===(r=(i=this[fn]).removeIcons)||void 0===r?void 0:r.call(i)),await(null===(s=(o=this[fn]).drawIcons)||void 0===s?void 0:s.call(o)))}}var wn;an=vn,dn=fn;const{complete:gn,error:yn,skip:An}=N,bn=Symbol("_private");class Tn extends En{constructor(n,i,r={}){super(n,i,r),this[wn]={handleMetric:(n,i)=>{var r;switch(n){case gn:this[fn].finish();break;case yn:i instanceof Error&&(this.error=i,this.errorCode=(null===(r=this.error)||void 0===r?void 0:r.code)&&t(this.error.code)?this.error.code:e.VAST_PROBLEM_DISPLAYING_MEDIA_FILE),this[fn].onErrorCallbacks.forEach((e=>e(this.error,{adUnit:this,vastChain:this.vastChain}))),this[fn].finish();break;case An:this.cancel()}this.emit(n,{adUnit:this,data:i,type:n})},drawIcons:async()=>{var e,t,n,i;if(!this.isFinished()&&(await(null===(t=(e=this[fn]).drawIcons)||void 0===t?void 0:t.call(e)),(null===(i=(n=this[fn]).hasPendingIconRedraws)||void 0===i?void 0:i.call(n))&&!this.isFinished())){const{videoElement:e}=this.videoAdContainer;De(e,"timeupdate",this[bn].drawIcons)}}},this.type="VAST";const{onFinishCallbacks:o}=this[fn],{handleMetric:s}=this[bn];this.hooks=r.hooks||{};const a=(({vastChain:e,videoAdContainer:t,hooks:n,pauseOnAdClick:i},r)=>{const[{ad:o}]=e,s=o&&fe(o),a=o&&ve(o),d=(e=>e.map((({ad:e})=>e)).reduce(((e,t)=>[...e,...t&&Z(t,Fe)||[]]),[]).map((({offset:e,uri:t})=>({offset:e,uri:t}))))(e),c=Object.assign({clickThroughUrl:a,pauseOnAdClick:i,progressEvents:d,skipoffset:s},n),l=gt.map((e=>Ue(e(t,r,c))));return()=>l.forEach((e=>e()))})({hooks:this.hooks,pauseOnAdClick:this.pauseOnAdClick,vastChain:this.vastChain,videoAdContainer:this.videoAdContainer},s);o.push(a)}async start(){if(this[fn].throwIfFinished(),this.isStarted())throw new yt("VastAdUnit already started");const t=this.vastChain[0].ad,{videoElement:n}=this.videoAdContainer,i=t&&Me(t,this.videoAdContainer,this.hooks);if(i)this.icons&&await this[bn].drawIcons(),(null==i?void 0:i.src)&&(n.src=i.src,this.assetUri=i.src),n.play();else{const t=new yt("Can't find a suitable media to play");t.code=e.VAST_LINEAR_ASSET_MISMATCH,this[bn].handleMetric(yn,t)}this[fn].started=!0}resume(){this.videoAdContainer.videoElement.play()}pause(){this.videoAdContainer.videoElement.pause()}skip(){const e=this.vastChain[0].ad,t=e&&fe(e),n=1e3*this.currentTime();"number"==typeof t&&n>=t&&this[bn].handleMetric(An)}paused(){return this.videoAdContainer.videoElement.paused}setVolume(e){this.videoAdContainer.videoElement.volume=e}getVolume(){return this.videoAdContainer.videoElement.volume}cancel(){this[fn].throwIfFinished(),this.videoAdContainer.videoElement.pause(),this[fn].finish()}duration(){return this.isStarted()?this.videoAdContainer.videoElement.duration:0}currentTime(){return this.isStarted()?this.videoAdContainer.videoElement.currentTime:0}async resize(e,t,n){if(await super.resize(e,t,n),this.isStarted()&&!this.isFinished()){const e=this.vastChain[0].ad,{videoElement:t}=this.videoAdContainer,n=e&&Me(e,this.videoAdContainer,this.hooks);n&&t.src!==n.src&&((e,t)=>{new Promise((n=>{const i={currentTime:e.currentTime,playing:!e.paused};i.playing&&e.pause(),t.src&&(e.src=t.src),e.load(),De(e,"loadeddata",(()=>{e.currentTime=i.currentTime,i.playing&&e.play(),n()}))}))})(t,n)}}}wn=bn;const Cn=["text/javascript","text/javascript1.0","text/javascript1.2","text/javascript1.4","text/jscript","application/javascript","application/x-javascript","text/ecmascript","text/ecmascript1.0","text/ecmascript1.2","text/ecmascript1.4","text/livescript","application/ecmascript","application/x-ecmascript"],In=({type:e})=>Cn.some((t=>t===e)),On="getAdIcons",_n="AdLoaded",Sn="AdStarted",Rn="AdStopped",Nn="AdSkipped",Ln="AdSizeChange",kn="AdDurationChange",Vn="AdRemainingTimeChange",Pn="AdVolumeChange",xn="AdImpression",Mn="AdVideoStart",Dn="AdVideoFirstQuartile",Fn="AdVideoMidpoint",Un="AdVideoThirdQuartile",jn="AdVideoComplete",$n="AdClickThru",Bn="AdUserAcceptInvitation",Wn="AdUserMinimize",Xn="AdUserClose",Hn="AdPaused",zn="AdPlaying",Yn="AdError",qn=[_n,Sn,Rn,Nn,"AdSkippableStateChange",Ln,"AdLinearChange",kn,"AdExpandedChange",Vn,Pn,xn,Mn,Dn,Fn,Un,jn,$n,"AdInteraction",Bn,Wn,Xn,Hn,zn,"AdLog",Yn],Gn=(e,t,n)=>new Promise(((i,r)=>{let o;const s=()=>{"number"==typeof n&&window.clearTimeout(o),e.unsubscribe(s,t),i()};"number"==typeof n&&(o=window.setTimeout((()=>{e.unsubscribe(s,t),r(new Error(`Timeout waiting for event '${t}'`))}),n)),e.subscribe(s,t)})),Qn=(e,t,n,...i)=>{const r=Gn(e,n,5e3),o=e[t];return null==o||o.apply(e,i),r},Kn=e=>{const t=e.split(".");return parseInt(t[0],10)};var Jn;const{complete:Zn,mute:ei,unmute:ti,skip:ni,start:ii,firstQuartile:ri,pause:oi,resume:si,impression:ai,midpoint:di,thirdQuartile:ci,clickThrough:li,error:hi,closeLinear:ui,creativeView:pi}=N,mi=qn.filter((e=>e!==_n)),vi=Symbol("_private");class fi extends En{constructor(n,i,r={}){super(n,i,r),this[Jn]={evtHandler:{[$n]:(e,t,n)=>{n&&this[vi].handleClickThrough(e),this.emit(li,{adUnit:this,type:li})},[kn]:()=>{this.emit(Je,{adUnit:this,type:Je})},[Yn]:n=>{this.error=(n=>{const i=n instanceof Error?n:new yt("VPAID general error");return i.code&&t(i.code)||(i.code=e.VPAID_ERROR),i})(n),this.errorCode=this.error.code,this[fn].onErrorCallbacks.forEach((e=>e(this.error,{adUnit:this,vastChain:this.vastChain}))),this[fn].finish(),this.emit(hi,{adUnit:this,type:hi})},[xn]:()=>{this[vi].videoStart||this[vi].handleVpaidEvent(Mn),this.emit(ai,{adUnit:this,type:ai})},[Hn]:()=>{this[vi].paused=!0,this.emit(oi,{adUnit:this,type:oi})},[zn]:()=>{this[vi].paused=!1,this.emit(si,{adUnit:this,type:si})},[Vn]:()=>{this.emit(Je,{adUnit:this,type:Je})},[Nn]:()=>{this.cancel(),this.emit(ni,{adUnit:this,type:ni})},[Sn]:()=>{this.emit(pi,{adUnit:this,type:pi})},[Rn]:()=>{this.emit(Rn,{adUnit:this,type:Rn}),this[fn].finish()},[Bn]:()=>{this.emit(L,{adUnit:this,type:L})},[Xn]:()=>{this.emit(ui,{adUnit:this,type:ui}),this[fn].finish()},[Wn]:()=>{this.emit(k,{adUnit:this,type:k})},[jn]:()=>{this.emit(Zn,{adUnit:this,type:Zn})},[Dn]:()=>{this.emit(ri,{adUnit:this,type:ri})},[Fn]:()=>{this.emit(di,{adUnit:this,type:di})},[Mn]:()=>{this[vi].videoStart||(this[vi].videoStart=!0,this[vi].paused=!1,this.emit(ii,{adUnit:this,type:ii}))},[Un]:()=>{this.emit(ci,{adUnit:this,type:ci})},[Pn]:()=>{const e=this.getVolume();this.emit(Qe,{adUnit:this,type:Qe}),0!==e||this[vi].muted||(this[vi].muted=!0,this.emit(ei,{adUnit:this,type:ei})),e>0&&this[vi].muted&&(this[vi].muted=!1,this.emit(ti,{adUnit:this,type:ti}))}},handleVpaidEvent:(e,...t)=>{const n=this[vi].evtHandler[e];n&&n(...t),this.emit(e,{adUnit:this,type:e})},handleClickThrough:e=>{if(this.paused()&&this.pauseOnAdClick)return void this.resume();const t=this.vastChain[0].ad,n="string"==typeof e&&e.length>0?e:t&&ve(t);this.pauseOnAdClick&&this.pause(),n&&window.open(n,"_blank")},getIcons:()=>{var e;if(null===(e=this.creativeAd)||void 0===e?void 0:e[On])try{this.creativeAd[On]()||delete this.icons}catch(e){delete this.icons}},drawIcons:async()=>{var e,t,n,i;this.isFinished()||(await(null===(t=(e=this[fn]).drawIcons)||void 0===t?void 0:t.call(e)),(null===(i=(n=this[fn]).hasPendingIconRedraws)||void 0===i?void 0:i.call(n))&&!this.isFinished()&&setTimeout(this[vi].drawIcons,500))},muted:!1,paused:!0},this.type="VPAID",this[vi].loadCreativePromise=(async(e,t)=>{const n=(e[0].ad&&pe(e[0].ad)||[]).find(In);if(!n||!n.src)throw new TypeError("VastChain does not contain a supported vpaid creative");const{src:i,type:r}=n;return await t.addScript(i,{type:r}),t.executionContext.getVPAIDAd()})(n,i)}async start(){if(this[fn].throwIfFinished(),this.isStarted())throw new Error("VpaidAdUnit already started");try{this.creativeAd=await this[vi].loadCreativePromise;const e=Gn(this.creativeAd,_n);for(const e of mi)this.creativeAd.subscribe(this[vi].handleVpaidEvent.bind(this,e),e);if(this[vi].getIcons(),((e,t)=>{const n=e.handshakeVersion(t);if(!((e,t)=>{const n=Kn(t);return!(n<1)&&n<=Kn(e)})(t,n))throw new Error(`Creative Version '${n}' not supported`)})(this.creativeAd,"2.0"),((e,t,n)=>{const{width:i,height:r}=t.element.getBoundingClientRect(),o=sn(i,r),s=(e=>{const t=(e=>{const t=/<Linear([\s\S]*)<\/Linear/gm.exec(e);return null==t?void 0:t[1]})(e),n=t&&(e=>{const t=/<AdParameters[\s\w="]*>([\s\S]*)<\/AdParameters>/gm.exec(e);return null==t?void 0:t[1].replace(/[\n\s]*<!\[CDATA\[[\n\s]*/,"").replace(/[\n\s]*\]\]>[\n\s]*$/,"").replace(/\]\]\]\]><!\[CDATA\[>/,"]]>").trim()})(t),i=!!t&&(e=>{const t=/<AdParameters[\s]*xmlEncoded="(.*?)">/gim.exec(e);return"true"===(null==t?void 0:t[1])})(t);return{AdParameters:n,xmlEncoded:i}})(n[0].XML);t.addSlot(i,r);const a={slot:t.slotElement,videoSlot:t.videoElement,videoSlotCanAutoPlay:t.isOriginalVideoElement};e.initAd(i,r,o,-1,s,a)})(this.creativeAd,this.videoAdContainer,this.vastChain),await e,this.videoAdContainer.isDestroyed())return;try{const{videoElement:e}=this.videoAdContainer;e.muted?(this[vi].muted=!0,this.setVolume(0)):this.setVolume(e.volume),await Qn(this.creativeAd,"startAd",Sn),this.icons&&await this[vi].drawIcons(),this[fn].started=!0}catch(e){this.cancel()}}catch(e){throw this[vi].handleVpaidEvent(Yn,e),e}}resume(){var e;null===(e=this.creativeAd)||void 0===e||e.resumeAd()}pause(){var e;null===(e=this.creativeAd)||void 0===e||e.pauseAd()}skip(){var e;null===(e=this.creativeAd)||void 0===e||e.skipAd()}paused(){return this.isFinished()||this[vi].paused}setVolume(e){var t;null===(t=this.creativeAd)||void 0===t||t.setAdVolume(e)}getVolume(){return this.creativeAd?this.creativeAd.getAdVolume():0}async cancel(){var e;this[fn].throwIfFinished();try{const t=this.creativeAd&&Gn(this.creativeAd,Rn,3e3);null===(e=this.creativeAd)||void 0===e||e.stopAd(),await t}catch(e){this[fn].finish()}}duration(){if(!this.creativeAd)return 0;const e=this.creativeAd.getAdDuration();return e<0?0:e}currentTime(){if(!this.creativeAd)return 0;const e=this.creativeAd.getAdRemainingTime();return e<0?0:this.duration()-e}async resize(e,t,n){if(await super.resize(e,t,n),this.creativeAd){if(this.isStarted()&&!this.isFinished()){const n=this.videoAdContainer.slotElement;n&&(n.style.height=`${t}px`,n.style.width=`${e}px`)}return Qn(this.creativeAd,"resizeAd",Ln,e,t,n)}}}function Ei(e,t,n){const{tracker:i,type:r}=n,o="VPAID"===r?new fi(e,t,n):new Tn(e,t,n);return Object.values(N).forEach((t=>o.on(t,(t=>{const{type:n,data:r}=t,s={data:r,errorCode:o.errorCode,tracker:i};((e,t,{data:n,errorCode:i,tracker:r=Ee,logger:o=console})=>{const{[e]:s}=be;s?s(t,{data:Object.assign(Object.assign({},n),{errorCode:i}),errorCode:i,tracker:r}):o.error(`Event '${e}' cannot be tracked`)})(n,e,s)})))),Object.values(P).forEach((t=>o.on(t,(t=>{const n={data:t.data,tracker:i};((e,t,{data:n,tracker:i=Ee,logger:r=console})=>{const{[e]:o}=Ce;o?o(t,{data:Object.assign({},n),tracker:i}):r.error(`Event '${e}' cannot be tracked`)})(t.type,e,n)})))),o}Jn=vi;class wi extends Error{constructor(e){super(e),this.name="VastError",Object.setPrototypeOf(this,wi.prototype)}}const gi=(e,{onAdReady:t})=>new Promise(((n,i)=>{const r=e=>()=>i(new Error(`Ad unit start rejected due to event '${e}'`));e.onError(i),e.on(T,(()=>n(e))),e.on(Xn,r(Xn)),e.on(S,r(S)),e.on(Rn,r(Rn)),t(e),e.start()})),yi=async(t,n,i)=>{((e,t)=>{if(!Array.isArray(e)||0===e.length)throw new TypeError("Invalid vastChain");if(!(t instanceof Le))throw new TypeError("Invalid VideoAdContainer")})(t,n);try{return await((t,n,i)=>{const[{ad:r}]=t;if(!r||!Boolean(pe(r))){const t=new wi("No valid creative found in the passed VAST chain");throw t.code=e.VAST_MEDIA_FILE_NOT_FOUND,t}const o=Ei(t,n,Object.assign(Object.assign({},i),{type:"VPAID"}));return gi(o,i)})(t,n,i)}catch(e){const[{ad:r}]=t;if(r&&((e,t)=>{const n=ue(e);return!!n&&n.some((e=>Ve(t,e)))})(r,n.videoElement))return((e,t,n)=>{const i=Ei(e,t,Object.assign(Object.assign({},n),{type:"VAST"}));return gi(i,n)})(t,n,i);throw e}};class Ai extends Error{constructor(e){super(e),this.name="FetchError",Object.setPrototypeOf(this,Ai.prototype)}}const bi=Symbol("requested"),Ti=e=>{e[bi]=!0},Ci=async(n,i,r=[])=>{var o;const s={requestTag:n};let a,d;try{const t=((e,t)=>{const[n]=e,i=Boolean(n)&&n.ad&&ce(n.ad)&&n.ad?(e=>{const t=$(e,"Wrapper"),n={};if(t){const{allowMultipleAds:e,fallbackOnNoAd:i,followAdditionalWrappers:r}=H(t);e&&(n.allowMultipleAds=ie(e)),i&&(n.fallbackOnNoAd=ie(i)),r&&(n.followAdditionalWrappers=ie(r))}return n})(n.ad):{};return Object.assign(Object.assign({},i),t)})(r,i);((t,{wrapperLimit:n=5})=>{if(t.length>n){const t=new wi("Wrapper Limit reached");throw t.code=e.VAST_TOO_MANY_REDIRECTS,t}})(r,t);let o=(async(t,n)=>{var i;let r;try{r=await(async(e,t={})=>{const n=Object.assign({credentials:"include"},t),i=await window.fetch(e,n);if(i.status>=400){const e=new Ai(i.statusText);throw e.response=i,e}return i})(t,n);const e=await r.text();return{response:r,XML:e}}catch(t){throw t.code=e.VAST_NONLINEAR_LOADING_FAILED,null!==(i=t.response)&&void 0!==i||(t.response=r),t}})(n,t);"number"==typeof t.timeout&&(d=t.timeout,a=Date.now(),o=Promise.race([o,new Promise(((t,n)=>{setTimeout((()=>{const t=new wi("RequestAd timeout");t.code=e.VAST_LOAD_TIMEOUT,n(t)}),d)}))]));const{response:c,XML:l}=await o;return s.response=c,s.XML=l,s.parsedXML=(t=>{try{return((e,t)=>{const n=e.parseFromString(t,"application/xml");return M.failOnParseError(n),U(n)})(Y,t)}catch(t){throw t.code=e.VAST_XML_PARSING_ERROR,t}})(s.XML),s.ad=(t=>{try{const e=(e=>{const t=oe(e);if(Array.isArray(t)&&t.length>0)return de(e)?t.filter(ae).sort(re)[0]:t[0]})(t);if(e)return Ti(e),e;throw new Error("No Ad")}catch(t){throw t.code=e.VAST_NO_ADS_AFTER_WRAPPER,t}})(s.parsedXML),(({ad:t,parsedXML:n},{allowMultipleAds:i=!0,followAdditionalWrappers:r=!0})=>{if(!ce(t)&&!(e=>Boolean($(e||{},"Inline")))(t)){const t=new wi("Invalid VAST, ad contains neither Wrapper nor Inline");throw t.code=e.VAST_SCHEMA_VALIDATION_ERROR,t}if(de(n)&&!i){const t=new wi("Multiple ads are not allowed");throw t.code=e.VAST_UNEXPECTED_MEDIA_FILE,t}if(ce(t)&&!r){const t=new wi("To follow additional wrappers is not allowed");throw t.code=e.VAST_UNEXPECTED_AD_TYPE,t}})(s,t),ce(s.ad)?(a&&d&&(d-=Date.now()-a),Ci(le(s.ad),Object.assign(Object.assign({},t),{timeout:d}),[s,...r])):[s,...r]}catch(n){return t(n.code)||(n.code=e.UNKNOWN_ERROR),s.errorCode=n.code,s.error=n,null!==(o=s.response)&&void 0!==o||(s.response=n.response),[s,...r]}},Ii=(e,t)=>{(e=>{if(!Array.isArray(e))throw new TypeError("Invalid VAST chain");if(0===e.length)throw new Error("No next ad to request")})(e);const[n]=e,i=(({ad:e,parsedXML:t},{fallbackOnNoAd:n=!0,useAdBuffet:i=!1})=>{const r=oe(t).filter((e=>!(e=>Boolean(e[bi]))(e)));let o;if(de(t))i&&(o=r.find((e=>!ae(e)))),e&&!o&&(o=((e,t)=>{const n=(se(e)||0)+1;return t.find((e=>se(e)===n))})(e,r));else if(r.length>0&&n){const[e]=r;o=e}return o})(n,t);if(i){const r=[Object.assign(Object.assign({},n),{ad:i}),...e.slice(1)];return Ti(i),ce(i)?Ci(le(i),t,r):Promise.resolve(r)}return Ii(e.slice(1),t)};const Oi=e=>(...t)=>{"function"==typeof e&&e(...t)},_i=async(n,i,r)=>{var{isCanceled:o}=r,s=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(r,["isCanceled"]);let a,d,c;const{onAdStart:l,onError:h,onRunFinish:u}=s;try{if("number"==typeof s.timeout&&(d=Date.now()),a=await n(),o())return void u();if(s.timeout&&d){const e=Date.now();s.timeout-=e-d,d=e}if(((t,n)=>{var i;if(!t||0===t.length)throw new Error("Invalid VastChain");const[r]=t;if(!n.vpaidEnabled&&(e=>Boolean(e[0].ad&&pe(e[0].ad)))(t)){const t=new wi("VPAID ads are not supported by the current player");t.code=e.VAST_UNEXPECTED_AD_TYPE,r.errorCode=e.VAST_UNEXPECTED_AD_TYPE,r.error=t}if(r.error)throw r.error;"function"==typeof(null===(i=n.hooks)||void 0===i?void 0:i.validateVastResponse)&&n.hooks.validateVastResponse(t)})(a,s),c=await(async(t,n,i)=>{let r;try{const{timeout:o}=i;r=((e,t)=>{if(!e)throw new TypeError("placeholder is required");return new Le(e,t)})(n,i.videoElement);let s=yi(t,r,i);if("number"==typeof o){let n,r=!1;const o=new Promise(((o,s)=>{n=window.setTimeout((()=>{const{tracker:n}=i;we(t,{errorCode:e.VAST_MEDIA_LOAD_TIMEOUT,tracker:n}),r=!0,s(new Error("Timeout while starting the ad"))}),i.timeout)})),a=async()=>{const e=await s;return r?e.isStarted()&&e.cancel():clearTimeout(n),e};s=Promise.race([a(),o])}const a=await s;return a.onFinish((()=>{null==r||r.destroy()})),a}catch(e){throw null==r||r.destroy(),e}})(((e,{hooks:t})=>"function"==typeof(null==t?void 0:t.transformVastResponse)?t.transformVastResponse(e):e)(a,s),i,Object.assign({},s)),o())return c.cancel(),void u();c.onError(h),c.onFinish(u),l(c)}catch(n){if(((n,i,r)=>{var o;let s=(null===(o=null==i?void 0:i[0])||void 0===o?void 0:o.errorCode)||(null==n?void 0:n.code);i&&s&&(t(s)||(s=e.UNKNOWN_ERROR),we(i,{errorCode:s,tracker:r}))})(n,a,s.tracker),h(n,{adUnit:c,vastChain:a}),!a||o())return void u();if(s.timeout&&d&&(s.timeout-=Date.now()-d),d&&s.timeout&&s.timeout<=0)return void u();_i((()=>Ii(a,s)),i,Object.assign(Object.assign({},s),{isCanceled:o}))}};document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#adTag"),t=document.querySelector(".vast-test-btn"),n=document.querySelector(".vast-media video"),i=document.querySelector(".video-ad-container");let r;const o=e=>{r=e,console.log("### onAdReady",r);const t=e=>{console.log(`### ${e.type}`,e.adUnit)};["pause","resume","finish","impression","start","skip","firstQuartile","midpoint","thirdQuartile","complete"].forEach((e=>{r.on(e,t)}))},s=()=>{const t=e.value,r=n.src,s=()=>{n.play(),n.removeEventListener("contentloadedmetadata",s),n.removeEventListener("canplay",s)};i.classList.add("active"),n.pause(),n.currentTime=0,console.log("### adTag",t),((e,t,n)=>{var i,r,o;let s,a=!1;const d=Oi(n.onAdStart),c=Object.assign(Object.assign({vpaidEnabled:!0},n),{onAdReady:Oi(n.onAdReady),onAdStart:e=>{s=e,d(s)},onError:Oi(n.onError),onRunFinish:Oi(n.onRunFinish)});/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&(null===(i=n.videoElement)||void 0===i?void 0:i.paused)&&(null===(r=n.videoElement)||void 0===r?void 0:r.canPlayType("application/vnd.apple.mpegurl"))&&(null===(o=n.videoElement)||void 0===o||o.load()),_i((()=>Ci(e,c)),t,Object.assign(Object.assign({},c),{isCanceled:()=>a}))})(t,i,{onAdReady:o,onError:e=>{console.log("### onError",e)},onRunFinish:()=>{console.log("### onRunFinish"),i.classList.remove("active"),n.src===r?n.play():(n.addEventListener("contentloadedmetadata",s),n.addEventListener("canplay",s),n.src=r,n.load())},timeout:15e3,videoElement:n,credentials:"omit"})};e.addEventListener("change",(()=>{e.value?(t.classList.add("active"),t.addEventListener("click",s)):(t.classList.remove("active"),t.removeEventListener("click",s))}))}))}(),i}()}));
//# sourceMappingURL=demo.js.map