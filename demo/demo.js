!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(function(){return function(){var e={296:function(e,t,n){var r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,s=c||l||Function("return this")(),f=Object.prototype.toString,d=Math.max,p=Math.min,h=function(){return s.Date.now()};function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var n=i.test(e);return n||a.test(e)?u(e.slice(2),n?2:8):o.test(e)?NaN:+e}e.exports=function(e,t,n){var r,o,i,a,u,c,l=0,s=!1,f=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function w(t){var n=r,i=o;return r=o=void 0,l=t,a=e.apply(i,n)}function b(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-l>=i}function E(){var e=h();if(b(e))return g(e);u=setTimeout(E,function(e){var n=t-(e-c);return f?p(n,i-(e-l)):n}(e))}function g(e){return u=void 0,y&&r?w(e):(r=o=void 0,a)}function A(){var e=h(),n=b(e);if(r=arguments,o=this,c=e,n){if(void 0===u)return function(e){return l=e,u=setTimeout(E,t),s?w(e):a}(c);if(f)return u=setTimeout(E,t),w(c)}return void 0===u&&(u=setTimeout(E,t)),a}return t=m(t)||0,v(n)&&(s=!!n.leading,i=(f="maxWait"in n)?d(m(n.maxWait)||0,t):i,y="trailing"in n?!!n.trailing:y),A.cancel=function(){void 0!==u&&clearTimeout(u),l=0,r=c=o=u=void 0},A.flush=function(){return void 0===u?a:g(h())},A}},722:function(e,t){"use strict";var n=[new RegExp("^<h3[^>]*>This page contains the following errors:</h3><div[^>]*>(.+?)\n?</div>"),new RegExp("^(.+)\n")];t.failOnParseError=function(e){return function(e){var t;if(null===e)throw new Error("Parse error");var r=function(e){return"parsererror"===e.documentElement.tagName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI?e.documentElement:("xml"===e.documentElement.tagName||"html"===e.documentElement.tagName)&&e.documentElement.childNodes&&e.documentElement.childNodes.length>0&&"parsererror"===e.documentElement.childNodes[0].nodeName?e.documentElement.childNodes[0]:"html"===e.documentElement.tagName&&e.documentElement.childNodes&&e.documentElement.childNodes.length>0&&"body"===e.documentElement.childNodes[0].nodeName&&e.documentElement.childNodes[0].childNodes&&e.documentElement.childNodes[0].childNodes.length&&"parsererror"===e.documentElement.childNodes[0].childNodes[0].nodeName?e.documentElement.childNodes[0].childNodes[0]:void 0}(e);if(void 0!==r)throw t=function(e){var t,r,o,i,a=(t=e,r=new XMLSerializer,Array.prototype.map.call(t.childNodes,(function(e){return r.serializeToString(e)})).join(""));for(o=0;o<n.length;o++)if(i=n[o].exec(a))return i[1]}(r)||"Parse error",new Error(t)}(e),e}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return function(){"use strict";var e;n.r(r),function(e){e[e.VAST_XML_PARSING_ERROR=100]="VAST_XML_PARSING_ERROR",e[e.VAST_SCHEMA_VALIDATION_ERROR=101]="VAST_SCHEMA_VALIDATION_ERROR",e[e.VAST_UNSUPPORTED_VERSION=102]="VAST_UNSUPPORTED_VERSION",e[e.VAST_UNEXPECTED_AD_TYPE=200]="VAST_UNEXPECTED_AD_TYPE",e[e.VAST_UNEXPECTED_LINEARITY=201]="VAST_UNEXPECTED_LINEARITY",e[e.VAST_UNEXPECTED_DURATION_ERROR=202]="VAST_UNEXPECTED_DURATION_ERROR",e[e.VAST_UNEXPECTED_MEDIA_FILE=203]="VAST_UNEXPECTED_MEDIA_FILE",e[e.VAST_WRAPPER_ERROR=300]="VAST_WRAPPER_ERROR",e[e.VAST_LOAD_TIMEOUT=301]="VAST_LOAD_TIMEOUT",e[e.VAST_TOO_MANY_REDIRECTS=302]="VAST_TOO_MANY_REDIRECTS",e[e.VAST_NO_ADS_AFTER_WRAPPER=303]="VAST_NO_ADS_AFTER_WRAPPER",e[e.VIDEO_PLAY_ERROR=400]="VIDEO_PLAY_ERROR",e[e.VAST_MEDIA_FILE_NOT_FOUND=401]="VAST_MEDIA_FILE_NOT_FOUND",e[e.VAST_MEDIA_LOAD_TIMEOUT=402]="VAST_MEDIA_LOAD_TIMEOUT",e[e.VAST_LINEAR_ASSET_MISMATCH=403]="VAST_LINEAR_ASSET_MISMATCH",e[e.VAST_PROBLEM_DISPLAYING_MEDIA_FILE=405]="VAST_PROBLEM_DISPLAYING_MEDIA_FILE",e[e.VAST_NONLINEAR_PLAYING_FAILED=500]="VAST_NONLINEAR_PLAYING_FAILED",e[e.VAST_NONLINEAR_DIMENSIONS_ERROR=501]="VAST_NONLINEAR_DIMENSIONS_ERROR",e[e.VAST_NONLINEAR_LOADING_FAILED=502]="VAST_NONLINEAR_LOADING_FAILED",e[e.VAST_NONLINEAR_ASSET_MISMATCH=503]="VAST_NONLINEAR_ASSET_MISMATCH",e[e.UNKNOWN_ERROR=900]="UNKNOWN_ERROR",e[e.VPAID_ERROR=901]="VPAID_ERROR"}(e||(e={}));var t,o=function(t){return Object.values(e).includes(t)},i="complete",a="clickThrough",u="error",c="firstQuartile",l="impression",s="viewable",f="notViewable",d="viewUndetermined",p="midpoint",h="mute",v="pause",m="playerCollapse",y="exitFullscreen",w="playerExpand",b="fullscreen",E="progress",g="resume",A="rewind",T="skip",_="start",C="thirdQuartile",O="unmute",I="iconClick",S="iconView",k="closeLinear",x="creativeView",P={clickThrough:a,closeLinear:k,complete:i,creativeView:x,error:u,exitFullscreen:y,firstQuartile:c,fullscreen:b,iconClick:I,iconView:S,impression:l,midpoint:p,mute:h,notViewable:f,otherAdInteraction:"otherAdInteraction",pause:v,playerCollapse:m,playerExpand:w,progress:E,resume:g,rewind:A,skip:T,start:_,thirdQuartile:C,timeSpentViewing:"timeSpentViewing",unmute:O,viewable:s,viewUndetermined:d},R="acceptInvitation",N="adCollapse",L="close",V={acceptInvitation:R,adCollapse:N,close:L},M=n(722);!function(e){e.CDATA="cdata",e.DOCUMENT="document",e.ELEMENT="element",e.TEXT="text"}(t||(t={}));var D,F,j,U,B=function(e){var n=function(e){switch(e.nodeType){case 1:return t.ELEMENT;case 3:case 4:return t.TEXT;case 9:return t.DOCUMENT;default:throw new Error("Unsupported element type")}}(e),r={type:n};if(e instanceof Element){var o=function(e){return 0===e.attributes.length?void 0:Object.fromEntries(Array.from(e.attributes).map((function(e){var t;return[e.nodeName,null!==(t=e.nodeValue)&&void 0!==t?t:void 0]})))}(e);o&&(r.attributes=o),r.name=e.nodeName.toLowerCase()}else(e instanceof Text||e instanceof CDATASection)&&(r.text=function(e){var t;return null===(t=e.nodeValue)||void 0===t?void 0:t.replace("<![CDATA[","").replace("]]>","").trim()}(e));var i=function(e){var t,n;if(e.hasChildNodes()){for(var r=Array.from(e.childNodes).filter((function(e){return[1,3,4].includes(e.nodeType)})),o=[],i=0,a=r;i<a.length;i++){var u=a[i],c=B(u);u instanceof Text&&!((null!==(n=null===(t=c.text)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0)||o.push(c)}return o}}(e);return i&&(r.elements=i),r},W=B,X=function(e){var t;return null!==(t=e.elements)&&void 0!==t?t:[]},G=function(e,t){return X(e).find((function(e){var n=e.name;return(void 0===n?"":n).toUpperCase()===t.toUpperCase()}))},H=function(e,t){return"string"==typeof t?function(e,t){return X(e).filter((function(e){var n=e.name;return(void 0===n?"":n).toUpperCase()===t.toUpperCase()}))}(e,t):X(e)},z=function(e){return X(e)[0]},Y=function(e){var t=e&&z(e);return t&&t.text},q=function(e){var t;return null!==(t=e.attributes)&&void 0!==t?t:{}},Q=function(e,t){return q(e)[t]},$=new DOMParser,K=function(e){if("string"==typeof e){var t=e.match(/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/);if(t){var n=(i=t[1],60*parseInt(i,10)*60*1e3+(o=t[2],60*parseInt(o,10)*1e3)+(r=t[3],1e3*parseInt(r,10))+(t[5]?parseInt(t[5],10):0));if(!isNaN(n))return n}}var r,o,i},J=function(e){return function(e){return/^\d+(\.\d+)?%$/g.test(e)}(e)?e:K(e)},Z=function(e){return G(e,"linear")},ee=function(e){var t=z(e),n=t&&G(t,"creatives");return n&&H(n).find(Z)},te=function(e){var t=q(e),n=t.event,r=t.offset,o=Y(e);return{event:n,offset:r&&J(r),uri:o}},ne=function(e,t){var n=e&&ee(e),r=n&&G(n,"Linear"),o=r&&G(r,"TrackingEvents"),i=o&&H(o,"Tracking");if(i&&i.length>0){var a=i.map(te);if(!t)return a;var u=a.filter((function(e){return e.event===t}));if(u.length>0)return u}},re=function(){return re=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},re.apply(this,arguments)},oe=function(e){var t="".concat(e).match(/\d+/g);return parseInt((null==t?void 0:t[0])||"",10)},ie=function(e){return/\d+/.test(e)?oe(e):e},ae=function(e){return"string"==typeof e?"true"===e:Boolean(e)},ue=function(e,t){var n=Q(e,"sequence"),r=Q(t,"sequence"),o=n&&parseInt(n,10),i=r&&parseInt(r,10);return"string"!=typeof o||"string"!=typeof i?0:o<i?-1:o>i?1:0},ce=function(e){var t=e&&G(e,"VAST"),n=t&&H(t,"Ad");return n&&n.length>0?n:[]},le=function(e){var t=Q(e,"sequence"),n=t&&parseInt(t,10);if("number"==typeof n&&!isNaN(n))return n},se=function(e){return Boolean(le(e))},fe=function(e){var t=ce(e);return Array.isArray(t)&&t.filter(se).length>1},de=function(e){return Boolean(G(e||{},"Wrapper"))},pe=function(e){var t=G(e,"Wrapper"),n=t&&G(t,"VastAdTagUri");return n&&Y(n)},he=function(e){var t=e&&z(e),n=t&&G(t,"ViewableImpression"),r=n&&H(n,"Viewable");if(r&&r.length>0)return r.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)},ve=function(e){var t=e&&ee(e),n=t&&G(t,"UniversalAdId"),r=n&&Y(n),o=t&&G(t,"Linear"),i=o&&G(o,"MediaFiles"),a=i&&H(i,"MediaFile");if(a&&a.length>0)return a.map((function(e){var t=Y(e),n=q(e),o=n.apiFramework,i=n.bitrate,a=n.codec,u=n.delivery,c=n.height,l=n.id,s=n.maintainAspectRatio,f=n.maxBitrate,d=n.minBitrate,p=n.scalable,h=n.type,v=n.width;return{apiFramework:o,bitrate:i,codec:a,delivery:u,height:c,id:l,maintainAspectRatio:s,maxBitrate:f,minBitrate:d,scalable:p,src:t,type:h,universalAdId:r,width:v}}))},me=function(e){var t=function(e){var t=e&&ee(e),n=t&&G(t,"Linear"),r=n&&G(n,"MediaFiles"),o=r&&H(r,"InteractiveCreativeFile");if(o&&o.length>0)return o.map((function(e){var t=q(e),n=t.apiFramework,r=t.type;return{apiFramework:n,src:Y(e),type:r}}))}(e);if(t)return t;var n=ve(e);return n&&(t=n.filter((function(e){var t=e.apiFramework,n=void 0===t?"":t;return"vpaid"===(null==n?void 0:n.toLowerCase())})).map((function(e){return{apiFramework:e.apiFramework,src:e.src,type:e.type}})),t.length>0)?t:void 0},ye=function(e){var t=e&&ee(e),n=t&&G(t,"Linear");return n&&G(n,"VideoClicks")},we=function(e){var t=ye(e),n=t&&G(t,"ClickThrough");return n&&Y(n)},be=function(e){var t=e&&ee(e),n=t&&G(t,"Linear"),r=n&&Q(n,"skipoffset");return r&&J(r)},Ee=function(e,t){var n=new Image;return n.src=function(e,t){void 0===t&&(t={});var n,r,o=e,i=(n=t,r={},Object.keys(n).forEach((function(e){r[e.toUpperCase()]=n[e]})),r);return i.CACHEBUSTING||(i.CACHEBUSTING=Math.round(1e10*Math.random())),i.TIMESTAMP||(i.TIMESTAMP=(new Date).toISOString()),Object.keys(i).forEach((function(e){var t=encodeURIComponent(i[e]);o=o.replace(new RegExp("\\["+e+"\\]","gm"),t)})),o}(e,t),n},ge=function(e,t){var n=t.errorCode,r=t.tracker,o=void 0===r?Ee:r;e.forEach((function(e){var t=e.ad,r=e.parsedXML,i=t&&function(e){var t=e&&z(e),n=t&&H(t,"Error");if(n&&n.length>0)return n.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)}(t)||function(e){var t=e&&G(e,"VAST"),n=t&&H(t,"Error");if(n&&n.length>0)return n.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)}(r);i&&i.map((function(e){return e&&o(e,{errorCode:n})}))}))},Ae=function(){return Ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ae.apply(this,arguments)},Te=function(){return Te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Te.apply(this,arguments)},_e=function(){return _e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_e.apply(this,arguments)},Ce=function(e){return function(t,n){var r=n.data,o=void 0===r?{}:r,i=n.tracker,a=void 0===i?Ee:i;t.forEach((function(t){var n=t.ad,r=n&&e(n);r&&(r&&"string"==typeof r?a(r,o):Array.isArray(r)&&r.map((function(e){var t=e.uri;return t&&a(t,o)})))}))}},Oe=function(){return Oe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Oe.apply(this,arguments)},Ie=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n=[];return e.length>0&&e.forEach((function(e){var r=e(t);Array.isArray(r)&&r.length>0&&n.push.apply(n,r.map((function(e){return{uri:e}})))})),n}},Se=function(e){return function(t){return ne(t,e)}},ke=((D={})[a]=Ce(Ie((function(e){var t=e&&ye(e),n=t&&H(t,"ClickTracking");if(n&&n.length>0)return n.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)}),(function(e){var t=ye(e),n=t&&H(t,"CustomClick");if(n&&n.length>0)return n.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)}))),D[k]=Ce(Se(k)),D[i]=Ce(Se(i)),D[x]=Ce(Se(x)),D[u]=ge,D[y]=Ce(Se(y)),D[c]=Ce(Se(c)),D[b]=Ce(Se(b)),D[I]=function(e,t){var n=t.data,r=void 0===n?{}:n,o=t.tracker,i=void 0===o?Ee:o,a=r.iconClickTracking;if(Array.isArray(a))for(var u=0,c=a;u<c.length;u++)i(c[u],Te({},r))},D[S]=function(e,t){var n=t.data,r=void 0===n?{}:n,o=t.tracker,i=void 0===o?Ee:o,a=r.iconViewTracking;if(Array.isArray(a))for(var u=0,c=a;u<c.length;u++)i(c[u],Ae({},r))},D[l]=Ce(Ie((function(e){var t=e&&z(e),n=t&&H(t,"Impression");if(n&&n.length>0)return n.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)}))),D[p]=Ce(Se(p)),D[h]=Ce(Se(h)),D[f]=Ce(Ie((function(e){var t=e&&z(e),n=t&&G(t,"ViewableImpression"),r=n&&H(n,"NotViewable");if(r&&r.length>0)return r.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)}))),D[v]=Ce(Se(v)),D[m]=Ce(Se(m)),D[w]=Ce(Se(w)),D[E]=function(e,t){var n=t.data,r=void 0===n?{}:n,o=t.tracker,i=void 0===o?Ee:o,a=r.progressUri;a&&i(a,_e({},r))},D[g]=Ce(Se(g)),D[A]=Ce(Se(A)),D[T]=Ce(Se(T)),D[_]=Ce(Se(_)),D[C]=Ce(Se(C)),D[O]=Ce(Se(O)),D[s]=Ce(Ie(he)),D[d]=Ce(Ie((function(e){var t=e&&z(e),n=t&&G(t,"ViewableImpression"),r=n&&H(n,"ViewUndetermined");if(r&&r.length>0)return r.map((function(e){var t;return null!==(t=Y(e))&&void 0!==t?t:""})).filter(Boolean)}))),D),xe=function(){return xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xe.apply(this,arguments)},Pe=function(e){return function(t){return function(e,t){var n=e&&ee(e),r=n&&G(n,"NonLinearAds"),o=r&&G(r,"TrackingEvents"),i=o&&H(o,"Tracking");if(i&&i.length>0){var a=i.map((function(e){return{event:q(e).event,uri:Y(e)}}));if(!t)return a;var u=a.filter((function(e){return e.event===t}));if(u.length>0)return u}}(t,e)}},Re=((F={})[R]=Ce(Pe(R)),F[N]=Ce(Pe(N)),F[L]=Ce(Pe(L)),F),Ne=function(e,t){var n=void 0===t?{}:t,r=n.async,o=void 0!==r&&r,i=n.defer,a=void 0!==i&&i,u=n.type,c=n.placeholder;if(!e)throw new TypeError('Missing required "src" parameter');return new Promise((function(t,n){var r=document.createElement("script"),i=c;r.type=null!=u?u:"text/javascript",r.async=o,r.defer=a,r.onerror=function(){return n(new URIError("The script ".concat(e," is not accessible.")))},r.onload=function(){return t(r)},i||(i=document.currentScript?document.currentScript.parentNode:document.head),r.src=e,null==i||i.appendChild(r)}))},Le=function(e){return e.contentDocument||e.contentWindow&&e.contentWindow.document},Ve="srcdoc"in document.createElement("iframe"),Me=function(){var e=document.createElement("iframe");return e.setAttribute("sandbox","allow-forms allow-popups allow-scripts allow-same-origin"),e.setAttribute("loading","eager"),e.style.margin="0",e.style.padding="0",e.style.border="none",e.style.width="0",e.style.height="0",e.style.position="absolute",e},De=function(e,t){return new Promise((function(n,r){var o,i=function(e,t){return"<!DOCTYPE html>\n<html>\n  <head><meta charset='UTF-8'></head>\n  <body style='margin:0;padding:0'>\n  <script type='text/javascript'>window.parent.postMessage('".concat(e,"_ready', '").concat(t,"');<\/script>\n  </body>\n</html>")}(t,(o=window.location).origin?o.origin:o.protocol+"//"+o.hostname+(o.port?":"+o.port:"")),a=Me();try{a.src="about:blank",e.appendChild(a);var u=Le(a);if(!u)throw new TypeError("iframe content document is not a Document");u.write(i)}catch(t){e.removeChild(a),Ve?((a=Me()).src="about:srcdoc",a.srcdoc=i,e.appendChild(a)):r(t)}var c=function(e){e.data==="".concat(t,"_ready")&&(window.removeEventListener("message",c),n(a))};window.addEventListener("message",c,!1)}))},Fe=function(){return Fe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Fe.apply(this,arguments)},je=(U=-1,function(){return"videoAdContainer_"+ ++U}),Ue=Symbol("hidden"),Be=function(){function e(e,t){if(this[j]={destroyed:!1,id:je(),iframe:void 0,readyPromise:void 0},!(e instanceof Element))throw new TypeError("placeholder is not an Element");var n;this.element=((n=document.createElement("div")).classList.add("mol-video-ad-container"),n.style.width="100%",n.style.height="100%",n),this.isOriginalVideoElement=Boolean(t),t?this.videoElement=t:(this.videoElement=function(e){void 0===e&&(e=document);var t=e.createElement("video");return t.style.width="100%",t.style.height="100%",t}(),this.element.appendChild(this.videoElement)),e.appendChild(this.element)}return e.prototype.addScript=function(e,t){var n,r,o,i,a;return void 0===t&&(t={}),r=this,o=void 0,a=function(){var r,o;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(i){switch(i.label){case 0:if(this.isDestroyed())throw new Error("VideoAdContainer has been destroyed");return(r=this[Ue].iframe)?[3,2]:[4,De(this.element,this[Ue].id)];case 1:r=i.sent(),this[Ue].iframe=r,this.executionContext=r.contentWindow,i.label=2;case 2:return o=null===(n=Le(r))||void 0===n?void 0:n.body,[2,Ne(e,Fe({placeholder:o},t))]}}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{c(a.next(e))}catch(e){t(e)}}function u(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(n,u)}c((a=a.apply(r,o||[])).next())}))},e.prototype.addSlot=function(e,t){if(this.isDestroyed())throw new Error("VideoAdContainer has been destroyed");this.slotElement||(this.slotElement=function(e,t,n){var r=document.createElement("DIV");return Object.assign(r.style,{border:"0px",cursor:"pointer",height:"".concat(n,"px"),left:"0px",margin:"0px",padding:"0px",position:"absolute",top:"0px",width:"".concat(t,"px")}),e.appendChild(r),r}(this.element,e,t))},e.prototype.destroy=function(){var e=this,t=new Promise((function(t){setTimeout((function(){var n;null===(n=e.element.parentNode)||void 0===n||n.removeChild(e.element),t()}),1e3)}));return this.element.style.zIndex="-9999",this[Ue].destroyed=!0,t},e.prototype.isDestroyed=function(){return this[Ue].destroyed},e}();j=Ue;var We,Xe,Ge,He=Be,ze={"3gp":"video/3gpp",avi:"video/x-msvideo",flv:"video/x-flv",m3u8:"application/x-mpegURL",m4v:"video/mp4",mov:"video/quicktime",mp4:"video/mp4",mpd:"application/dash+xml",ogv:"video/ogg",ts:"video/MP2T",webm:"video/webm",wmv:"video/x-ms-wmv"},Ye=function(e,t){var n=t.src,r=t.type;return e.canPlayType(r||function(e){var t=e.match(/\.([^./?]+)(\?[^/]+)?$/i),n=t&&t[1];return n&&ze[n]||"video/"+n}(n||""))},qe=function(e){var t=Number(e.width)||0,n=Number(e.height)||0;return{aspectRatio:n?Math.floor(t/n*10)/10:0,height:n,width:t}},Qe=function(e,t){return function(e,t){var n=qe(t);return e.slice(0).sort((function(e,t){var r=qe(e),o=qe(t),i=Math.abs(n.width-r.width),a=Math.abs(n.width-o.width);return Math.abs(n.aspectRatio-r.aspectRatio)-Math.abs(n.aspectRatio-o.aspectRatio)||i-a}))}(e,t)[0]},$e=function(e,t,n,r){var o=r.getMediaFile,i=void 0===o?Qe:o,a=n.getBoundingClientRect(),u=ve(e),c=null==u?void 0:u.filter((function(e){return Ye(t,e)}));return c&&i(c,a)},Ke=function(e,t,n){var r=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return e.removeEventListener(t,r),n.apply(void 0,o)};return e.addEventListener(t,r),function(){e.removeEventListener(t,r)}},Je=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Ze=P.progress,et=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{e.apply(void 0,n)}catch(e){null==t||t.error(e)}}},tt=P.fullscreen,nt=P.exitFullscreen,rt=P.playerCollapse,ot=P.playerExpand,it=P.pause,at=P.resume,ut=P.rewind,ct=P.skip,lt=function(){var e=document.createElement("button");return e.classList.add("mol-vast-skip-control"),e.type="button",e.innerHTML="skip",e.style.position="absolute",e.style.bottom="15px",e.style.right="15px",e},st=P.error,ft="volumeChanged",dt="finish",pt="adProgress",ht=P.complete,vt=P.firstQuartile,mt=P.midpoint,yt=P.start,wt=P.thirdQuartile,bt=function(e,t){return 100*e/t},Et=function(e,t){return bt(e,t)>=99},gt=P.mute,At=P.unmute,Tt=function(e){return e.muted||0===e.volume},_t=P.impression,Ct=P.creativeView,Ot=function(e,t){for(var n=String(e);n.length<t;)n="0"+n;return n},It=function(e){var t=Math.floor(e/36e5),n=Math.floor(e/6e4%60),r=Math.floor(e/1e3%60),o=e%1e3;return Ot(t,2)+":"+Ot(n,2)+":"+Ot(r,2)+"."+Ot(o,3)},St=P.progress,kt=function(e){return 1e3*e},xt=function(e){var t=e.offset,n=e.uri,r="number"==typeof t||Boolean(t&&function(e){return/^\d+(\.\d+)?%$/g.test(e)&&!isNaN(parseFloat(e))}(t)),o="string"==typeof n&&n.length>0;return r&&o},Pt=function(e,t){return"number"==typeof e?e:parseFloat(e)/100*t},Rt=P.clickThrough,Nt=function(){var e=document.createElement("a");return e.classList.add("mol-vast-clickthrough"),e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.left="0",e.style.top="0",e},Lt=[function(e,t,n){var r=e.videoElement,o=e.element,i=void 0===n?{}:n,a=i.clickThroughUrl,u=i.pauseOnAdClick,c=void 0===u||u,l=i.createClickControl,s=void 0===l?Nt:l,f=o||r.parentNode,d=s(),p=!document.body.contains(d);return p&&f.appendChild(d),a&&d instanceof HTMLAnchorElement&&(d.href=a,d.target="_blank"),d.onclick=function(e){e.stopPropagation(),r.paused&&c?(e.preventDefault(),r.play()):(c&&r.pause(),t(Rt))},function(){p&&f.removeChild(d)}},function(t,n){var r=t.videoElement,o=function(){var t,o=null!==(t=r.error)&&void 0!==t?t:void 0;o&&Object.defineProperty(o,"code",{get:function(){return e.VAST_PROBLEM_DISPLAYING_MEDIA_FILE}}),n(st,o)};return r.addEventListener("error",o),function(){r.removeEventListener("error",o)}},function(e,t){for(var n=e.videoElement,r=["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"],o=!1,i=function(){(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null)===n?(o=!0,t(ot),t(tt)):o&&(o=!1,t(rt),t(nt))},a=0,u=r;a<u.length;a++){var c=u[a];document.addEventListener(c,i)}return function(){for(var e=0,t=r;e<t.length;e++){var n=t[e];document.removeEventListener(n,i)}}},function(e,t){var n=e.videoElement,r=!1,o=function(){var e=n.currentTime;!r&&e>0&&(r=!0,t(_t),t(Ct),n.removeEventListener("timeupdate",o))};return n.addEventListener("timeupdate",o),function(){n.removeEventListener("timeupdate",o)}},function(e,t){var n=e.videoElement,r=!1,o=!0,i=function(){r?o&&(o=!1,t(at)):(r=!0,o=!1)},a=function(){o||(o=!0,t(it))};return n.addEventListener("play",i),n.addEventListener("pause",a),function(){n.removeEventListener("play",i),n.removeEventListener("pause",a)}},function(e,t,n){var r=e.videoElement,o=(void 0===n?{}:n).progressEvents,i=void 0===o?[]:o,a=r.duration,u=kt(a),c=0,l=kt(r.currentTime),s=i.filter(xt).map((function(e){var t=e.offset,n=e.uri;return{offset:Pt(t,u),uri:n}})),f=function(){var e=r.currentTime,n=Math.abs(e-l);c+=kt(n),l=e;var o=s.reduce((function(e,t){var n=t.offset;return"number"==typeof n&&c>=n?e.toCall.push(t):e.stillPending.push(t),e}),{stillPending:[],toCall:[]}),i=o.stillPending,a=o.toCall;s=i,a.forEach((function(e){var n=e.uri;t(St,{contentplayhead:It(c),progressUri:n})})),0===s.length&&r.removeEventListener("timeupdate",f)};return s.length>0&&r.addEventListener("timeupdate",f),function(){r.removeEventListener("timeupdate",f)}},function(e,t){var n=e.videoElement,r=n.currentTime,o=function(){var e=n.currentTime-r;e<0&&Math.abs(e)>=1&&t(ut),r=n.currentTime};return n.addEventListener("timeupdate",o),function(){n.removeEventListener("timeupdate",o)}},function(e,t,n){var r,o=void 0===n?{}:n,i=o.skipoffset,a=o.createSkipControl,u=void 0===a?lt:a;if(!i)return function(){return null};var c=e.videoElement,l=e.element,s=function(){var e=1e3*c.currentTime;!r&&"number"==typeof i&&e>=i&&((r=u()).onclick=function(e){var n;return null===(n=e.stopPropagation)||void 0===n||n.call(e),t(ct),!1},l.appendChild(r),c.removeEventListener("timeupdate",s))};return c.addEventListener("timeupdate",s),function(){c.removeEventListener("timeupdate",s),r&&l.removeChild(r)}},function(e,t){var n=e.videoElement,r=!1,o=!1,i=!1,a=!1,u=!1,c={start:{isFired:function(e){return!r&&e>0},callback:function(){r=!0,t(yt)}},firstQuartile:{isFired:function(e,t){return!o&&function(e,t){return bt(e,t)>=25}(e,t)},callback:function(){o=!0,t(vt)}},midpoint:{isFired:function(e,t){return!i&&function(e,t){return bt(e,t)>=50}(e,t)},callback:function(){i=!0,t(mt)}},thirdQuartile:{isFired:function(e,t){return!a&&function(e,t){return bt(e,t)>=75}(e,t)},callback:function(){a=!0,t(wt)}},complete:{isFired:function(e,t){return!u&&Et(e,t)},callback:function(){u=!0,t(ht)}}},l=function(){var e=n.duration,r=n.currentTime;for(var o in c)if(c[o].isFired(r,e)){c[o].callback();break}t(pt)},s=function(){var e=n.duration,r=n.currentTime;!u&&Et(r,e)&&(u=!0,t(ht)),n.removeEventListener("ended",s),n.removeEventListener("timeupdate",l)};return n.addEventListener("timeupdate",l),n.addEventListener("ended",s),function(){n.removeEventListener("timeupdate",l),n.removeEventListener("ended",s)}},function(e,t){var n=e.videoElement,r=Tt(n),o=function(){t(ft),r&&!Tt(n)?t(At):!r&&Tt(n)&&t(gt),r=Tt(n)};return n.addEventListener("volumechange",o),function(){n.removeEventListener("volumechange",o)}}],Vt=function(){return Vt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Vt.apply(this,arguments)},Mt=function(e,t){var n=e.vastChain,r=e.videoAdContainer,o=e.hooks,i=e.pauseOnAdClick,a=n[0].ad,u=a&&be(a),c=a&&we(a),l=function(e){return e.map((function(e){return e.ad})).reduce((function(e,t){var n=t&&ne(t,Ze)||[];return Je(Je([],e,!0),n,!0)}),[]).map((function(e){return{offset:e.offset,uri:e.uri}}))}(n),s=Vt({clickThroughUrl:c,pauseOnAdClick:i,progressEvents:l,skipoffset:u},o),f=Lt.map((function(e){return et(e(r,t,s))}));return function(){return f.forEach((function(e){return e()}))}},Dt=(We=function(e,t){return We=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},We(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}We(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Ft=function(e){function t(n){var r=e.call(this,n)||this;return r.name="AdUnitError",Object.setPrototypeOf(r,t.prototype),r}return Dt(t,e),t}(Error),jt=n(296),Ut=n.n(jt),Bt=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,Wt=function(){},Xt=["style","clientWidth","clientHeight"],Gt=Symbol("mutationHandlers"),Ht=Symbol("mutationObserver"),zt=Symbol("resizeHandlers"),Yt=Symbol("resizeElement"),qt=function(e,t,n){var r=(void 0===n?{}:n).threshold,o=void 0===r?20:r;!function(e,t){if(!(e instanceof Element))throw new TypeError("Target is not an Element node");if(!(t instanceof Function))throw new TypeError("Callback is not a function")}(e,t);var i=function(e){var t=e.style,n=e.clientHeight,r=e.clientWidth;return[t.width,t.height,r,n].join(".")},a=i(e),u=Ut()((function(){var n=i(e);n!==a&&(a=n,t())}),o),c=Bt?function(e,t){var n;return e[Gt]||(e[Gt]=[],e[Ht]=function(e,t){var n=new Bt((function(e){for(var n=0;n<e.length;n++){var r=e[n].attributeName;r&&Xt.includes(r)&&t()}}));return n.observe(e,{attributes:!0,characterData:!1,childList:!0}),n}(e,(function(){var t;null===(t=e[Gt])||void 0===t||t.forEach((function(e){return e()}))}))),null===(n=e[Gt])||void 0===n||n.push(t),function(){var n,r,o;e[Gt]=null===(n=e[Gt])||void 0===n?void 0:n.filter((function(e){return e!==t})),0===(null===(r=e[Gt])||void 0===r?void 0:r.length)&&(null===(o=e[Ht])||void 0===o||o.disconnect(),delete e[Gt],delete e[Ht])}}(e,u):Wt,l=function(e,t){var n;return e[zt]||(e[zt]=[],e[Yt]=function(e){var t=document.createElement("iframe");return t.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; border: 0; overflow: hidden; pointer-events: none; z-index: -1;"),t.setAttribute("type","text/html"),t.setAttribute("loading","eager"),t.onload=function(){t.contentWindow&&t.contentWindow.addEventListener("resize",e)},t.src="about:blank",t}((function(){var t;null===(t=e[zt])||void 0===t||t.forEach((function(e){return e()}))})),"static"===getComputedStyle(e).position&&(e.style.position="relative"),e.appendChild(e[Yt])),null===(n=e[zt])||void 0===n||n.push(t),function(){var n,r;e[zt]=null===(n=e[zt])||void 0===n?void 0:n.filter((function(e){return e!==t})),0===(null===(r=e[zt])||void 0===r?void 0:r.length)&&(e.removeChild(e[Yt]),delete e[zt],delete e[Yt])}}(e,u);return function(){c(),l()}},Qt=window.IntersectionObserver,$t=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Kt=function(){},Jt=Symbol("intersectionHandlers"),Zt=Symbol("intersectionObserver"),en=[],tn=[],nn=function(e,t,n){var r=void 0===n?{}:n,o=r.threshold,i=void 0===o?100:o,a=r.viewabilityOffset,u=void 0===a?.4:a;if(function(e,t){if(!(e instanceof Element))throw new TypeError("Target is not an Element node");if(!(t instanceof Function))throw new TypeError("Callback is not a function")}(e,t),!Qt)return t(void 0),Kt;var c=!1,l=Ut()((function(n){n.forEach((function(n){if(n.target===e){var r=!document.hidden&&n.intersectionRatio>u;r!==c&&(c=r,t(r))}})),tn=n}),i),s=function(e,t){var n,r;if(!e[Jt]){e[Jt]=[];var o={root:null,rootMargin:"0px",threshold:$t([],new Array(11),!0).map((function(e,t){return t/10}))};e[Zt]=new Qt((function(t,n){var r;null===(r=e[Jt])||void 0===r||r.forEach((function(e){return e(t,n)}))}),o),null===(n=e[Zt])||void 0===n||n.observe(e)}return null===(r=e[Jt])||void 0===r||r.push(t),function(){var n,r,o;e[Jt]=null===(n=e[Jt])||void 0===n?void 0:n.filter((function(e){return e!==t})),0===(null===(r=e[Jt])||void 0===r?void 0:r.length)&&(null===(o=e[Zt])||void 0===o||o.disconnect(),delete e[Jt],delete e[Zt])}}(e,l),f=function(e,t){var n=function(){en&&en.forEach((function(e){return e()}))};return en.push(t),1===en.length&&document.addEventListener("visibilitychange",n),function(){0===(en=en.filter((function(e){return e!==t}))).length&&document.removeEventListener("visibilitychange",n)}}(0,(function(){return l(tn)}));return function(){s(),f()}},rn=function(){function e(e){this.events={},this.logger=e||console}return e.prototype.on=function(e,t){var n=this.events;return(n[e]||(n[e]=[])).push(t),this},e.prototype.removeListener=function(e,t){var n=this.events,r=n[e]||(n[e]=[]);return n[e]=r.filter((function(e){return e!==t&&e._!==t})),this},e.prototype.removeAllListeners=function(e){return e?delete this.events[e]:this.events={},this},e.prototype.once=function(e,t){var n=this,r=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];n.removeListener(e,r),t.apply(void 0,o)};return r._=t,this.on(e,r)},e.prototype.emit=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.events,i=o[e]||(o[e]=[]),a=i.length>0;return i.forEach((function(e){try{e.apply(void 0,n)}catch(e){e instanceof Error&&t.logger.error(e,e.stack)}})),a},e}(),on=rn,an=function(e){var t=void 0===e?{}:e,n=t.staticResource,r=t.htmlResource,o=t.iFrameResource;return n||r||o||void 0},un=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},cn="UNKNOWN",ln=function(e){return 1===e.length?e[0]:function(e){var t=window.devicePixelRatio||0;return e.slice(0).sort((function(e,n){return Math.abs(t-(e.pxratio||0))-Math.abs(t-(n.pxratio||0))}))}(e)[0]},sn=function(e){var t=e.map((function(e){return e.ad})).filter(Boolean),n=t.reduce((function(e,t){return un(un([],e,!0),function(e){var t=e&&ee(e),n=t&&G(t,"linear"),r=n&&G(n,"Icons"),o=r&&H(r,"Icon");if(o&&o.length>0)return o.map((function(e){return re(re(re(re({},function(e){var t=q(e),n=t.duration,r=t.height,o=t.offset,i=t.program,a=t.pxratio,u=t.width,c=t.xPosition,l=void 0===c?"right":c,s=t.yPosition,f=void 0===s?"top":s;return{duration:n&&K(n)||void 0,height:r&&oe(r)||void 0,offset:o&&K(o)||void 0,program:i,pxratio:a&&parseInt(a,10)||void 0,width:u&&oe(u)||void 0,xPosition:l&&ie(l),yPosition:f&&ie(f)}}(e)),function(e){var t=G(e,"StaticResource"),n=G(e,"HTMLResource"),r=G(e,"IFrameResource");return t?{staticResource:Y(t)}:n?{htmlResource:Y(n)}:r?{iFrameResource:Y(r)}:{staticResource:Y(e)}}(e)),function(e){var t=H(e,"IconViewTracking").map((function(e){return Y(e)})).filter(Boolean);return 0===t.length?{}:{iconViewTracking:t}}(e)),function(e){var t=G(e,"IconClicks"),n=t&&G(t,"IconClickThrough"),r=t&&H(t,"IconClickTracking").map((function(e){return Y(e)})).filter(Boolean);return{iconClickThrough:n&&Y(n),iconClickTracking:r&&r.length>0?r:void 0}}(e))}))}(t)||[],!0)}),[]);if(n.length>0){var r=function(e){return t=an,n={},e.filter((function(e){var r=t(e);return!(!r||n.hasOwnProperty(r)||(n[r]=!0,0))}));var t,n}(n);return function(e){var t=function(e){return e.reduce((function(e,t){var n,r,o=null!==(n=t.program)&&void 0!==n?n:cn;return null!==(r=e[o])&&void 0!==r||(e[o]=[]),e[o].push(t),e}),{})}(e);return Object.keys(t).reduce((function(e,n){return n===cn?un(un([],e,!0),t[cn],!0):un(un([],e,!0),[ln(t[n])],!1)}),[])}(r)}},fn=function(e,t){var n,r,o=!0,i=new Promise((function(e,t){n=e,r=t})),a=Ke(e,t,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o=!1,n(e)}));return{cancel:function(){o&&(o=!1,a(),r(new Error("waitFor was canceled")))},promise:i}},dn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pn=function(e){function t(n){var r=e.call(this,n)||this;return r.name="FetchError",Object.setPrototypeOf(r,t.prototype),r}return dn(t,e),t}(Error),hn=function(e){return t=void 0,n=void 0,o=function(){var t,n,r;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(o){switch(o.label){case 0:return[4,fetch(e)];case 1:if(t=o.sent(),n=t.headers.get("Content-Type"),t.status>=400)throw(r=new pn(t.statusText)).response=t,r;if(!n||!function(e){var t=e.toLowerCase();return["text/plain","text/html"].some((function(e){return t.includes(e)}))}(n))throw(r=new pn("fetchHtml error, invalid Content-Type ".concat(n))).response=t,r;return[2,t.text()]}}))},new((r=void 0)||(r=Promise))((function(e,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function u(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,u)}c((o=o.apply(t,n||[])).next())}));var t,n,r,o},vn=document.createElement("div"),mn=function(e,t){var n=t.staticResource,r=t.htmlResource,o=t.iFrameResource;return n?function(e,t){var n=t.document,r=t.data,o=r.height,i=r.width,a=n.createElement("img");return i&&(a.width=i),o&&(a.height=o),a.src=e,a}(n,{data:t,document:e}):r?function(e,t){var n=t.document,r=t.data,o=r.height,i=r.width,a=n.createElement("div");return i&&(a.style.width="".concat(i,"px")),o&&(a.style.height="".concat(o,"px")),hn(e).then((function(e){a.innerHTML=e,a.dispatchEvent(new CustomEvent("load"))})).catch((function(){a.dispatchEvent(new CustomEvent("error"))})),a}(r,{data:t,document:e}):o?function(e,t){var n=t.document,r=t.data,o=r.height,i=r.width,a=n.createElement("iframe");return a.setAttribute("sandbox","allow-forms allow-popups allow-scripts"),a.setAttribute("loading","eager"),i&&(a.width=i.toString()),o&&(a.height=o.toString()),a.src=e,a.frameBorder="0",a.style.border="none",a}(o,{data:t,document:e}):vn},yn=function(){},wn=function(e,t){var n=t.document,r=t.placeholder;return new Promise((function(t,o){try{var i=mn(n,e),a=fn(i,"error"),u=fn(i,"load"),c=function(){r.contains(i)&&(r.removeChild(i),i.style.zIndex="0")};a.promise.then((function(){u.cancel(),c(),o(new Error("Error loading resource"))})).catch(yn),u.promise.then((function(){a.cancel(),c(),t(i)})).catch(yn),i.style.zIndex="-9999",r.appendChild(i)}catch(e){o(e)}}))},bn=function(e){return e.height*e.width},En=function(e){return e.left+e.width},gn=function(e){return e.left},An=function(e){return e.top},Tn=function(e){return e.top+e.height},_n=function(e,t){var n=function(e,t){var n=t.drawnIcons,r=t.placeholder,o=bn(r.getBoundingClientRect());return bn(e)+n.reduce((function(e,t){var n=t.width,r=t.height;return n&&r?e+bn({width:n,height:r}):e}),0)<=.35*o}(e,t),r=function(e,t){var n=t.placeholder.getBoundingClientRect();return e.left>=0&&e.left+e.width<=n.width&&e.top>=0&&e.top+e.height<=n.height}(e,t),o=function(e,t){return!t.drawnIcons.some((function(t){return function(e,t){return gn(e)<=En(t)&&En(e)>=gn(t)&&Tn(e)>=An(t)&&An(e)<=Tn(t)}(e,t)}))}(e,t);return n&&r&&o},Cn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},On=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},In=function(){},Sn=function(e,t){return Cn(void 0,void 0,void 0,(function(){var n;return On(this,(function(r){switch(r.label){case 0:return e.element?[3,2]:[4,wn(e,t)];case 1:((n=r.sent())instanceof HTMLIFrameElement||n instanceof HTMLImageElement)&&(n.width="100%",n.height="100%"),n.style.height="100%",n.style.width="100%",e.element=function(e,t,n){var r=(void 0===n?{}:n).onIconClick,o=void 0===r?In:r,i=document.createElement("a");return t.iconClickThrough&&(i.href=t.iconClickThrough,i.target="_blank"),t.iFrameResource&&(e.style.pointerEvents="none"),i.onclick=function(e){void 0!==Event.prototype.stopPropagation&&e.stopPropagation(),o(t)},i.appendChild(e),i}(n,e,t),r.label=2;case 2:return[2,e.element]}}))}))},kn=function(e,t){return Cn(void 0,void 0,void 0,(function(){var n,r,o,i;return On(this,(function(a){switch(a.label){case 0:return n=t.placeholder,[4,Sn(e,t)];case 1:if(r=a.sent(),o=function(e,t,n){var r,o,i,a,u,c=n.drawnIcons,l=n.placeholder,s=e.signature,f=t.getBoundingClientRect(),d=l.getBoundingClientRect(),p=e.width||f.width,h=e.height||f.height,v=e.xPosition||"right",m=e.yPosition||"top";if(function(e){return!["left","right"].includes(String(e).toLowerCase())}(v))r=v;else{var y=c.filter((function(e){return e.xPosition===v&&e.yPosition===m}));r=function(e,t,n,r){var o=n.reduce((function(e,t){return e+(t.width?t.width+1:0)}),0);return"left"===e?o:r-o-t}(v,p,y,d.width)}!function(e){return!["top","bottom"].includes(String(e).toLowerCase())}(m)?(i=m,a=h,u=d.height,o="top"===i?0:u-a):o=m;var w="".concat(r,"-").concat(o,"_").concat(p,"x").concat(h);return Object.assign(e,{height:h,left:r,signature:w,top:o,updated:s!==w,width:p})}(e,r,t),!_n(o,t))throw null===(i=r.parentNode)||void 0===i||i.removeChild(r),new Error("Icon can't be rendered");return r.parentNode&&!o.updated||n.appendChild(function(e,t){var n=t.height,r=t.width,o=t.left,i=t.top,a=t.yPosition;return e.style.position="absolute",e.style.left="".concat(o,"px"),"bottom"===a?e.style.bottom="0":e.style.top="".concat(i,"px"),e.style.height="".concat(n,"px"),e.style.width="".concat(r,"px"),e}(r,o)),[2,o]}}))}))},xn=function(e,t){var n=t.onIconClick,r=t.videoAdContainer,o=t.logger,i=void 0===o?console:o,a=r.element,u=r.videoElement,c=[],l=e.reduce((function(e,t){return function(e,t){var n=1e3*t.currentTime,r=1e3*t.duration,o="string"==typeof e.offset?parseInt(e.offset,10):e.offset||0,i=e.duration||r;return o<=n&&n-o<=i}(t,u)?e.iconsToShow.push(t):e.otherIcons.push(t),e}),{iconsToShow:[],otherIcons:[]}),s=l.iconsToShow;return l.otherIcons.forEach((function(e){var t,n=e.element;null===(t=null==n?void 0:n.parentNode)||void 0===t||t.removeChild(n)})),s.reduce((function(e,t){return e.then((function(){return kn(t,{document:document,drawnIcons:c,onIconClick:n,placeholder:a})})).then((function(e){c.push(e)})).catch((function(e){return i.log(e)}))}),Promise.resolve()).then((function(){return c}))},Pn=function(){return Pn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pn.apply(this,arguments)},Rn=Symbol("firstRenderPending"),Nn=function(){},Ln=function(e,t){var n=t.videoAdContainer,r=t.onIconView,o=void 0===r?Nn:r,i=t.onIconClick,a=void 0===i?Nn:i,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["videoAdContainer","onIconView","onIconClick"]),c=n.videoElement,l=n.element;return e.forEach((function(e){e[Rn]=!0})),{drawIcons:function(){return t=void 0,r=void 0,c=function(){var t;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(r){switch(r.label){case 0:return[4,xn(e,Pn({onIconClick:a,videoAdContainer:n},u))];case 1:return t=r.sent(),l.dispatchEvent(new CustomEvent("iconsDrawn")),t.forEach((function(e){e[Rn]&&(o(e),e[Rn]=!1)})),[2]}}))},new((i=void 0)||(i=Promise))((function(e,n){function o(e){try{u(c.next(e))}catch(e){n(e)}}function a(e){try{u(c.throw(e))}catch(e){n(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}u((c=c.apply(t,r||[])).next())}));var t,r,i,c},hasPendingIconRedraws:function(){return function(e,t){var n=1e3*t.currentTime,r=1e3*t.duration,o=e.filter((function(e){return!e.offset||e.offset<n})),i=e.filter((function(e){return e.duration&&e.duration<r}));return o.length>0||i.length>0}(e,c)},removeIcons:function(){return function(e){return e.filter((function(e){var t=e.element;return Boolean(null==t?void 0:t.parentNode)})).forEach((function(e){var t,n=e.element;return null===(t=null==n?void 0:n.parentNode)||void 0===t?void 0:t.removeChild(n)}))}(e)}}},Vn=function(e,t){var n=window.screen;return e+100>n.width&&t+100>n.height?"fullscreen":e<400?"thumbnail":"normal"},Mn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dn=P.start,Fn=P.viewable,jn=P.notViewable,Un=P.viewUndetermined,Bn=P.iconClick,Wn=P.iconView,Xn=Symbol("_private"),Gn=Symbol("_protected"),Hn=function(e){function t(t,n,r){var o,i,a,u,c,l=void 0===r?{}:r,s=l.viewability,f=void 0!==s&&s,d=l.responsive,p=void 0!==d&&d,h=l.logger,v=void 0===h?console:h,m=l.pauseOnAdClick,y=void 0===m||m,w=e.call(this,v)||this;w[Xe]={addIcons:function(){if(w.icons){var e=Ln(w.icons,{logger:w.logger,onIconClick:function(e){return w.emit(Bn,{adUnit:w,data:e,type:Bn})},onIconView:function(e){return w.emit(Wn,{adUnit:w,data:e,type:Wn})},videoAdContainer:w.videoAdContainer}),t=e.drawIcons,n=e.hasPendingIconRedraws,r=e.removeIcons;w[Gn].drawIcons=t,w[Gn].removeIcons=r,w[Gn].hasPendingIconRedraws=n,w[Gn].onFinishCallbacks.push(r)}},setupViewableImpression:function(){var e,t=nn(w.videoAdContainer.element,(function(t){w.isFinished()||w[Gn].viewable||("boolean"==typeof t?t?e=window.setTimeout(w[Xn].handleViewableImpression,2e3,Fn):clearTimeout(e):w[Xn].handleViewableImpression(Un))}),{viewabilityOffset:.5});w[Gn].onFinishCallbacks.push((function(){t(),clearTimeout(e),w[Gn].viewable||w[Xn].handleViewableImpression(jn)}))},handleViewableImpression:function(e){w[Gn].viewable=Boolean(e),w.emit(e,{adUnit:w,type:e})},setupViewability:function(){var e=nn(w.videoAdContainer.element,(function(e){w.isFinished()||"boolean"==typeof e&&(e?w.resume():w.pause())}));w[Gn].onFinishCallbacks.push(e)},setupResponsive:function(){var e=w.videoAdContainer.element;w[Gn].size={height:e.clientHeight,viewmode:Vn(e.clientWidth,e.clientHeight),width:e.clientWidth};var t=qt(e,(function(){if(!w.isFinished()){var t=w[Gn].size,n=e.clientHeight,r=e.clientWidth;n===(null==t?void 0:t.height)&&r===(null==t?void 0:t.width)||w.resize(r,n,Vn(r,n))}}));w[Gn].onFinishCallbacks.push(t)}},w[Ge]={finished:!1,started:!1,viewable:!1,onErrorCallbacks:[],onFinishCallbacks:[],finish:function(){w.isFinished()||(w[Gn].finished=!0,w[Gn].onFinishCallbacks.forEach((function(e){return e()})),w.emit(dt,{adUnit:w,type:dt}))},throwIfCalled:function(){throw new Error("VideoAdUnit method must be implemented on child class")},throwIfFinished:function(){if(w.isFinished())throw new Error("VideoAdUnit is finished")}},w.vastChain=t,w.videoAdContainer=n,w.icons=sn(t),w.pauseOnAdClick=y,w[Gn].onFinishCallbacks.push((o=w.videoAdContainer.videoElement,i=0,a=0,u=function(){o.duration-i>3&&(o.pause(),o.play(),o.currentTime=i)},c=function(){var e=o.currentTime;Math.abs(e-i)>3?((a+=1)>=2&&o.pause(),o.currentTime=i):i=e},o.addEventListener("timeupdate",c),o.addEventListener("ended",u),function(){o.removeEventListener("timeupdate",c),o.removeEventListener("ended",u)})),w[Xn].addIcons();var b=t.some((function(e){var t=e.ad;return t&&he(t)}));return b&&w.once(Dn,w[Xn].setupViewableImpression),f&&w.once(Dn,w[Xn].setupViewability),p&&w.once(Dn,w[Xn].setupResponsive),w}return Mn(t,e),t.prototype.start=function(){this[Gn].throwIfCalled()},t.prototype.resume=function(){this[Gn].throwIfCalled()},t.prototype.pause=function(){this[Gn].throwIfCalled()},t.prototype.skip=function(){this[Gn].throwIfCalled()},t.prototype.setVolume=function(e){this[Gn].throwIfCalled()},t.prototype.getVolume=function(){this[Gn].throwIfCalled()},t.prototype.cancel=function(){this[Gn].throwIfCalled()},t.prototype.duration=function(){this[Gn].throwIfCalled()},t.prototype.paused=function(){this[Gn].throwIfCalled()},t.prototype.currentTime=function(){this[Gn].throwIfCalled()},t.prototype.onFinish=function(e){if("function"!=typeof e)throw new TypeError("Expected a callback function");this[Gn].onFinishCallbacks.push(et(e,this.logger))},t.prototype.onError=function(e){if("function"!=typeof e)throw new TypeError("Expected a callback function");this[Gn].onErrorCallbacks.push(et(e,this.logger))},t.prototype.isFinished=function(){return this[Gn].finished},t.prototype.isStarted=function(){return this[Gn].started},t.prototype.resize=function(e,t,n){var r,o,i,a,u,c,l,s;return u=this,c=void 0,s=function(){return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(u){switch(u.label){case 0:return this[Gn].size={height:t,viewmode:n,width:e},this.isStarted()&&!this.isFinished()&&this.icons?[4,null===(o=(r=this[Gn]).removeIcons)||void 0===o?void 0:o.call(r)]:[3,3];case 1:return u.sent(),[4,null===(a=(i=this[Gn]).drawIcons)||void 0===a?void 0:a.call(i)];case 2:u.sent(),u.label=3;case 3:return[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function n(e){try{o(s.next(e))}catch(e){t(e)}}function r(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof l?o:new l((function(e){e(o)}))).then(n,r)}o((s=s.apply(u,c||[])).next())}))},t}(on);Xe=Xn,Ge=Gn;var zn,Yn=Hn,qn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},$n=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},Kn=P.complete,Jn=P.error,Zn=P.skip,er=Symbol("_private"),tr=function(t){function n(n,r,i){void 0===i&&(i={});var a=t.call(this,n,r,i)||this;a[zn]={handleMetric:function(t,n){var r;switch(t){case Kn:a[Gn].finish();break;case Jn:n instanceof Error&&(a.error=n,a.errorCode=(null===(r=a.error)||void 0===r?void 0:r.code)&&o(a.error.code)?a.error.code:e.VAST_PROBLEM_DISPLAYING_MEDIA_FILE),a[Gn].onErrorCallbacks.forEach((function(e){return e(a.error,{adUnit:a,vastChain:a.vastChain})})),a[Gn].finish();break;case Zn:a.cancel()}a.emit(t,{adUnit:a,data:n,type:t})},drawIcons:function(){return Qn(a,void 0,void 0,(function(){var e,t,n,r,o;return $n(this,(function(i){switch(i.label){case 0:return this.isFinished()?[2]:[4,null===(n=(t=this[Gn]).drawIcons)||void 0===n?void 0:n.call(t)];case 1:return i.sent(),(null===(o=(r=this[Gn]).hasPendingIconRedraws)||void 0===o?void 0:o.call(r))&&!this.isFinished()&&(e=this.videoAdContainer.videoElement,Ke(e,"timeupdate",this[er].drawIcons)),[2]}}))}))}},a.type="VAST";var u=a[Gn].onFinishCallbacks,c=a[er].handleMetric;a.hooks=i.hooks||{};var l=Mt({hooks:a.hooks,pauseOnAdClick:a.pauseOnAdClick,vastChain:a.vastChain,videoAdContainer:a.videoAdContainer},c);return u.push(l),a}return qn(n,t),n.prototype.start=function(){return Qn(this,void 0,void 0,(function(){var t,n,r,o,i,a;return $n(this,(function(u){switch(u.label){case 0:if(this[Gn].throwIfFinished(),this.isStarted())throw new Ft("VastAdUnit already started");return t=this.vastChain[0].ad,n=this.videoAdContainer,r=n.videoElement,o=n.element,(i=t&&$e(t,r,o,this.hooks))?this.icons?[4,this[er].drawIcons()]:[3,2]:[3,3];case 1:u.sent(),u.label=2;case 2:return(null==i?void 0:i.src)&&(r.src=i.src,this.assetUri=i.src),r.play(),[3,4];case 3:(a=new Ft("Can't find a suitable media to play")).code=e.VAST_LINEAR_ASSET_MISMATCH,this[er].handleMetric(Jn,a),u.label=4;case 4:return this[Gn].started=!0,[2]}}))}))},n.prototype.resume=function(){this.videoAdContainer.videoElement.play()},n.prototype.pause=function(){this.videoAdContainer.videoElement.pause()},n.prototype.skip=function(){var e=this.vastChain[0].ad,t=e&&be(e),n=1e3*this.currentTime();"number"==typeof t&&n>=t&&this[er].handleMetric(Zn)},n.prototype.paused=function(){return this.videoAdContainer.videoElement.paused},n.prototype.setVolume=function(e){this.videoAdContainer.videoElement.volume=e},n.prototype.getVolume=function(){return this.videoAdContainer.videoElement.volume},n.prototype.cancel=function(){this[Gn].throwIfFinished(),this.videoAdContainer.videoElement.pause(),this[Gn].finish()},n.prototype.duration=function(){return this.isStarted()?this.videoAdContainer.videoElement.duration:0},n.prototype.currentTime=function(){return this.isStarted()?this.videoAdContainer.videoElement.currentTime:0},n.prototype.resize=function(e,n,r){return Qn(this,void 0,void 0,(function(){var o,i,a,u,c;return $n(this,(function(l){switch(l.label){case 0:return[4,t.prototype.resize.call(this,e,n,r)];case 1:return l.sent(),this.isStarted()&&!this.isFinished()&&(o=this.vastChain[0].ad,i=this.videoAdContainer,a=i.videoElement,u=i.element,(c=o&&$e(o,a,u,this.hooks))&&a.src!==c.src&&function(e,t){new Promise((function(n){var r={currentTime:e.currentTime,playing:!e.paused};r.playing&&e.pause(),t.src&&(e.src=t.src),e.load(),Ke(e,"loadeddata",(function(){e.currentTime=r.currentTime,r.playing&&e.play(),n()}))}))}(a,c)),[2]}}))}))},n}(Yn);zn=er;var nr,rr=tr,or=["text/javascript","text/javascript1.0","text/javascript1.2","text/javascript1.4","text/jscript","application/javascript","application/x-javascript","text/ecmascript","text/ecmascript1.0","text/ecmascript1.2","text/ecmascript1.4","text/livescript","application/ecmascript","application/x-ecmascript"],ir=function(e){var t=e.type;return or.some((function(e){return e===t}))},ar=function(e,t){return n=void 0,r=void 0,i=function(){var n,r,o;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(i){switch(i.label){case 0:if(!(n=(e[0].ad&&me(e[0].ad)||[]).filter(ir)[0])||!n.src)throw new TypeError("VastChain does not contain a supported vpaid creative");return r=n.src,o=n.type,[4,t.addScript(r,{type:o})];case 1:return i.sent(),[2,t.executionContext.getVPAIDAd()]}}))},new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{c(i.next(e))}catch(e){t(e)}}function u(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,u)}c((i=i.apply(n,r||[])).next())}));var n,r,o,i},ur="getAdIcons",cr="AdLoaded",lr="AdStarted",sr="AdStopped",fr="AdSkipped",dr="AdSizeChange",pr="AdDurationChange",hr="AdRemainingTimeChange",vr="AdVolumeChange",mr="AdImpression",yr="AdVideoStart",wr="AdVideoFirstQuartile",br="AdVideoMidpoint",Er="AdVideoThirdQuartile",gr="AdVideoComplete",Ar="AdClickThru",Tr="AdUserAcceptInvitation",_r="AdUserMinimize",Cr="AdUserClose",Or="AdPaused",Ir="AdPlaying",Sr="AdError",kr=[cr,lr,sr,fr,"AdSkippableStateChange",dr,"AdLinearChange",pr,"AdExpandedChange",hr,vr,mr,yr,wr,br,Er,gr,Ar,"AdInteraction",Tr,_r,Cr,Or,Ir,"AdLog",Sr],xr=function(e,t,n){return new Promise((function(r,o){var i,a=function(){"number"==typeof n&&window.clearTimeout(i),e.unsubscribe(a,t),r()};"number"==typeof n&&(i=window.setTimeout((function(){e.unsubscribe(a,t),o(new Error("Timeout waiting for event '".concat(t,"'")))}),n)),e.subscribe(a,t)}))},Pr=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=xr(e,n,5e3),a=e[t];return null==a||a.apply(e,r),i},Rr=function(e){var t=e.split(".");return parseInt(t[0],10)},Nr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lr=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},Vr=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},Mr=P.complete,Dr=P.mute,Fr=P.unmute,jr=P.skip,Ur=P.start,Br=P.firstQuartile,Wr=P.pause,Xr=P.resume,Gr=P.impression,Hr=P.midpoint,zr=P.thirdQuartile,Yr=P.clickThrough,qr=P.error,Qr=P.closeLinear,$r=P.creativeView,Kr=kr.filter((function(e){return e!==cr})),Jr=Symbol("_private"),Zr=function(t){function n(n,r,i){var a;void 0===i&&(i={});var u=t.call(this,n,r,i)||this;return u[nr]={evtHandler:(a={},a[Ar]=function(e,t,n){n&&u[Jr].handleClickThrough(e),u.emit(Yr,{adUnit:u,type:Yr})},a[pr]=function(){u.emit(pt,{adUnit:u,type:pt})},a[Sr]=function(t){u.error=function(t){var n=t instanceof Error?t:new Ft("VPAID general error");return n.code&&o(n.code)||(n.code=e.VPAID_ERROR),n}(t),u.errorCode=u.error.code,u[Gn].onErrorCallbacks.forEach((function(e){return e(u.error,{adUnit:u,vastChain:u.vastChain})})),u[Gn].finish(),u.emit(qr,{adUnit:u,type:qr})},a[mr]=function(){u[Jr].videoStart||u[Jr].handleVpaidEvent(yr),u.emit(Gr,{adUnit:u,type:Gr})},a[Or]=function(){u[Jr].paused=!0,u.emit(Wr,{adUnit:u,type:Wr})},a[Ir]=function(){u[Jr].paused=!1,u.emit(Xr,{adUnit:u,type:Xr})},a[hr]=function(){u.emit(pt,{adUnit:u,type:pt})},a[fr]=function(){u.cancel(),u.emit(jr,{adUnit:u,type:jr})},a[lr]=function(){u.emit($r,{adUnit:u,type:$r})},a[sr]=function(){u.emit(sr,{adUnit:u,type:sr}),u[Gn].finish()},a[Tr]=function(){u.emit(R,{adUnit:u,type:R})},a[Cr]=function(){u.emit(Qr,{adUnit:u,type:Qr}),u[Gn].finish()},a[_r]=function(){u.emit(N,{adUnit:u,type:N})},a[gr]=function(){u.emit(Mr,{adUnit:u,type:Mr})},a[wr]=function(){u.emit(Br,{adUnit:u,type:Br})},a[br]=function(){u.emit(Hr,{adUnit:u,type:Hr})},a[yr]=function(){u[Jr].videoStart||(u[Jr].videoStart=!0,u[Jr].paused=!1,u.emit(Ur,{adUnit:u,type:Ur}))},a[Er]=function(){u.emit(zr,{adUnit:u,type:zr})},a[vr]=function(){var e=u.getVolume();u.emit(ft,{adUnit:u,type:ft}),0!==e||u[Jr].muted||(u[Jr].muted=!0,u.emit(Dr,{adUnit:u,type:Dr})),e>0&&u[Jr].muted&&(u[Jr].muted=!1,u.emit(Fr,{adUnit:u,type:Fr}))},a),handleVpaidEvent:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=u[Jr].evtHandler[e];r&&r.apply(void 0,t),u.emit(e,{adUnit:u,type:e})},handleClickThrough:function(e){if(u.paused()&&u.pauseOnAdClick)u.resume();else{var t=u.vastChain[0].ad,n="string"==typeof e&&e.length>0?e:t&&we(t);u.pauseOnAdClick&&u.pause(),n&&window.open(n,"_blank")}},getIcons:function(){var e;if(null===(e=u.creativeAd)||void 0===e?void 0:e[ur])try{u.creativeAd[ur]()||delete u.icons}catch(e){delete u.icons}},drawIcons:function(){return Lr(u,void 0,void 0,(function(){var e,t,n,r;return Vr(this,(function(o){switch(o.label){case 0:return this.isFinished()?[2]:[4,null===(t=(e=this[Gn]).drawIcons)||void 0===t?void 0:t.call(e)];case 1:return o.sent(),(null===(r=(n=this[Gn]).hasPendingIconRedraws)||void 0===r?void 0:r.call(n))&&!this.isFinished()&&setTimeout(this[Jr].drawIcons,500),[2]}}))}))},muted:!1,paused:!0},u.type="VPAID",u[Jr].loadCreativePromise=ar(n,r),u}return Nr(n,t),n.prototype.start=function(){return Lr(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return Vr(this,(function(u){switch(u.label){case 0:if(this[Gn].throwIfFinished(),this.isStarted())throw new Error("VpaidAdUnit already started");u.label=1;case 1:return u.trys.push([1,10,,11]),e=this,[4,this[Jr].loadCreativePromise];case 2:for(e.creativeAd=u.sent(),t=xr(this.creativeAd,cr),n=0,r=Kr;n<r.length;n++)o=r[n],this.creativeAd.subscribe(this[Jr].handleVpaidEvent.bind(this,o),o);return this[Jr].getIcons(),function(e,t){var n=e.handshakeVersion(t);if(!function(e,t){var n=Rr(t);return!(n<1)&&n<=Rr(e)}(t,n))throw new Error("Creative Version '".concat(n,"' not supported"))}(this.creativeAd,"2.0"),function(e,t,n){var r,o,i,a=t.element.getBoundingClientRect(),u=a.width,c=a.height,l=Vn(u,c),s=(f=n[0].XML,d=/<Linear([\s\S]*)<\/Linear/gm.exec(f),o=(r=null==d?void 0:d[1])&&function(e){var t=/<AdParameters[\s\w="]*>([\s\S]*)<\/AdParameters>/gm.exec(e);return null==t?void 0:t[1].replace(/[\n\s]*<!\[CDATA\[[\n\s]*/,"").replace(/[\n\s]*\]\]>[\n\s]*$/,"").replace(/\]\]\]\]><!\[CDATA\[>/,"]]>").trim()}(r),i=!!r&&function(e){var t=/<AdParameters[\s]*xmlEncoded="(.*?)">/gim.exec(e);return"true"===(null==t?void 0:t[1])}(r),{AdParameters:o,xmlEncoded:i});var f,d;t.addSlot(u,c);var p={slot:t.slotElement,videoSlot:t.videoElement,videoSlotCanAutoPlay:t.isOriginalVideoElement};e.initAd(u,c,l,-1,s,p)}(this.creativeAd,this.videoAdContainer,this.vastChain),[4,t];case 3:if(u.sent(),this.videoAdContainer.isDestroyed())return[3,9];u.label=4;case 4:return u.trys.push([4,8,,9]),(i=this.videoAdContainer.videoElement).muted?(this[Jr].muted=!0,this.setVolume(0)):this.setVolume(i.volume),[4,Pr(this.creativeAd,"startAd",lr)];case 5:return u.sent(),this.icons?[4,this[Jr].drawIcons()]:[3,7];case 6:u.sent(),u.label=7;case 7:return this[Gn].started=!0,[3,9];case 8:return u.sent(),this.cancel(),[3,9];case 9:return[3,11];case 10:throw a=u.sent(),this[Jr].handleVpaidEvent(Sr,a),a;case 11:return[2]}}))}))},n.prototype.resume=function(){var e;null===(e=this.creativeAd)||void 0===e||e.resumeAd()},n.prototype.pause=function(){var e;null===(e=this.creativeAd)||void 0===e||e.pauseAd()},n.prototype.skip=function(){var e;null===(e=this.creativeAd)||void 0===e||e.skipAd()},n.prototype.paused=function(){return this.isFinished()||this[Jr].paused},n.prototype.setVolume=function(e){var t;null===(t=this.creativeAd)||void 0===t||t.setAdVolume(e)},n.prototype.getVolume=function(){return this.creativeAd?this.creativeAd.getAdVolume():0},n.prototype.cancel=function(){var e;return Lr(this,void 0,void 0,(function(){var t;return Vr(this,(function(n){switch(n.label){case 0:this[Gn].throwIfFinished(),n.label=1;case 1:return n.trys.push([1,3,,4]),t=this.creativeAd&&xr(this.creativeAd,sr,3e3),null===(e=this.creativeAd)||void 0===e||e.stopAd(),[4,t];case 2:return n.sent(),[3,4];case 3:return n.sent(),this[Gn].finish(),[3,4];case 4:return[2]}}))}))},n.prototype.duration=function(){if(!this.creativeAd)return 0;var e=this.creativeAd.getAdDuration();return e<0?0:e},n.prototype.currentTime=function(){if(!this.creativeAd)return 0;var e=this.creativeAd.getAdRemainingTime();return e<0?0:this.duration()-e},n.prototype.resize=function(e,n,r){return Lr(this,void 0,void 0,(function(){var o;return Vr(this,(function(i){switch(i.label){case 0:return[4,t.prototype.resize.call(this,e,n,r)];case 1:return i.sent(),this.creativeAd?(this.isStarted()&&!this.isFinished()&&(o=this.videoAdContainer.slotElement)&&(o.style.height="".concat(n,"px"),o.style.width="".concat(e,"px")),[2,Pr(this.creativeAd,"resizeAd",dr,e,n,r)]):[2]}}))}))},n}(Yn);nr=Jr;var eo=Zr,to=function(e,t,n){var r=n.tracker,o="VPAID"===n.type?new eo(e,t,n):new rr(e,t,n);return Object.values(P).forEach((function(t){return o.on(t,(function(t){var n=t.type,i={data:t.data,errorCode:o.errorCode,tracker:r};!function(e,t,n){var r=n.data,o=n.errorCode,i=n.tracker,a=void 0===i?Ee:i,u=n.logger,c=void 0===u?console:u,l=ke[e];l?l(t,{data:Oe(Oe({},r),{errorCode:o}),errorCode:o,tracker:a}):c.error("Event '".concat(e,"' cannot be tracked"))}(n,e,i)}))})),Object.values(V).forEach((function(t){return o.on(t,(function(t){var n={data:t.data,tracker:r};!function(e,t,n){var r=n.data,o=n.tracker,i=void 0===o?Ee:o,a=n.logger,u=void 0===a?console:a,c=Re[e];c?c(t,{data:xe({},r),tracker:i}):u.error("Event '".concat(e,"' cannot be tracked"))}(t.type,e,n)}))})),o},no=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ro=function(e){function t(n){var r=e.call(this,n)||this;return r.name="VastError",Object.setPrototypeOf(r,t.prototype),r}return no(t,e),t}(Error),oo=function(){return oo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},oo.apply(this,arguments)},io=function(e,t){var n=t.onAdReady;return new Promise((function(t,r){var o=function(e){return function(){return r(new Error("Ad unit start rejected due to event '".concat(e,"'")))}};e.onError(r),e.on(_,(function(){return t(e)})),e.on(Cr,o(Cr)),e.on(k,o(k)),e.on(sr,o(sr)),n(e),e.start()}))},ao=function(t,n,r){var o=t[0].ad;if(!o||!Boolean(me(o))){var i=new ro("No valid creative found in the passed VAST chain");throw i.code=e.VAST_MEDIA_FILE_NOT_FOUND,i}var a=to(t,n,oo(oo({},r),{type:"VPAID"}));return io(a,r)},uo=function(e,t,n){var r=to(e,t,oo(oo({},n),{type:"VAST"}));return io(r,n)},co=function(e,t,n){return r=void 0,o=void 0,a=function(){var r,o;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(i){switch(i.label){case 0:!function(e,t){if(!Array.isArray(e)||0===e.length)throw new TypeError("Invalid vastChain");if(!(t instanceof He))throw new TypeError("Invalid VideoAdContainer")}(e,t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,ao(e,t,n)];case 2:return[2,i.sent()];case 3:if(r=i.sent(),(o=e[0].ad)&&(a=o,u=t.videoElement,(c=ve(a))&&c.some((function(e){return Ye(u,e)}))))return[2,uo(e,t,n)];throw r;case 4:return[2]}var a,u,c}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{c(a.next(e))}catch(e){t(e)}}function u(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(n,u)}c((a=a.apply(r,o||[])).next())}));var r,o,i,a},lo=function(t,n,r){return o=void 0,i=void 0,u=function(){var o,i,a,u,c,l,s,f;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),i=r.timeout,o=function(e,t){if(!e)throw new TypeError("placeholder is required");return new He(e,t)}(n,r.videoElement),a=co(t,o,r),"number"==typeof i&&(u=!1,l=new Promise((function(n,o){c=window.setTimeout((function(){var n=r.tracker;ge(t,{errorCode:e.VAST_MEDIA_LOAD_TIMEOUT,tracker:n}),u=!0,o(new Error("Timeout while starting the ad"))}),r.timeout)})),a=Promise.race([a.then((function(e){return u?e.isStarted()&&e.cancel():clearTimeout(c),e})),l])),[4,a];case 1:return(s=d.sent()).onFinish((function(){null==o||o.destroy()})),[2,s];case 2:throw f=d.sent(),null==o||o.destroy(),f;case 3:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{c(u.next(e))}catch(e){t(e)}}function r(e){try{c(u.throw(e))}catch(e){t(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a((function(e){e(o)}))).then(n,r)}c((u=u.apply(o,i||[])).next())}));var o,i,a,u},so=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fo=function(e){function t(n){var r=e.call(this,n)||this;return r.name="FetchError",Object.setPrototypeOf(r,t.prototype),r}return so(t,e),t}(Error),po=function(e,t){return void 0===t&&(t={}),n=void 0,r=void 0,i=function(){var n,r,o,i;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(a){switch(a.label){case 0:return n={credentials:"include"},r=Object.assign({},n,t),[4,window.fetch(e,r)];case 1:if((o=a.sent()).status>=400)throw(i=new fo(o.statusText)).response=o,i;return[2,o]}}))},new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{c(i.next(e))}catch(e){t(e)}}function u(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,u)}c((i=i.apply(n,r||[])).next())}));var n,r,o,i},ho=Symbol("requested"),vo=function(e){e[ho]=!0},mo=function(){return mo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},mo.apply(this,arguments)},yo=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},wo=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},bo=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Eo=function(t){try{return function(e,t){var n=e.parseFromString(t,"application/xml");return M.failOnParseError(n),W(n)}($,t)}catch(t){throw t.code=e.VAST_XML_PARSING_ERROR,t}},go=function(t,n,r){return void 0===r&&(r=[]),yo(void 0,void 0,void 0,(function(){var i,a,u,c,l,s,f,d,p,h;return wo(this,(function(v){switch(v.label){case 0:i={requestTag:t},v.label=1;case 1:return v.trys.push([1,3,,4]),c=function(e,t){var n=e[0],r=Boolean(n)&&n.ad&&de(n.ad)&&n.ad?function(e){var t=G(e,"Wrapper"),n={};if(t){var r=q(t),o=r.allowMultipleAds,i=r.fallbackOnNoAd,a=r.followAdditionalWrappers;o&&(n.allowMultipleAds=ae(o)),i&&(n.fallbackOnNoAd=ae(i)),a&&(n.followAdditionalWrappers=ae(a))}return n}(n.ad):{};return mo(mo({},r),t)}(r,n),function(t,n){var r=n.wrapperLimit,o=void 0===r?5:r;if(t.length>o){var i=new ro("Wrapper Limit reached");throw i.code=e.VAST_TOO_MANY_REDIRECTS,i}}(r,c),l=function(t,n){return yo(void 0,void 0,void 0,(function(){var r,o,i,a;return wo(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),[4,po(t,n)];case 1:return[4,(r=u.sent()).text()];case 2:return o=u.sent(),[2,{response:r,XML:o}];case 3:throw(i=u.sent()).code=e.VAST_NONLINEAR_LOADING_FAILED,null!==(a=i.response)&&void 0!==a||(i.response=r),i;case 4:return[2]}}))}))}(t,c),"number"==typeof c.timeout&&(u=c.timeout,a=Date.now(),l=Promise.race([l,new Promise((function(t,n){setTimeout((function(){var t=new ro("RequestAd timeout");t.code=e.VAST_LOAD_TIMEOUT,n(t)}),u)}))])),[4,l];case 2:return s=v.sent(),f=s.response,d=s.XML,i.response=f,i.XML=d,i.parsedXML=Eo(i.XML),i.ad=function(t){try{var n=function(e){var t=ce(e);if(Array.isArray(t)&&t.length>0)return fe(e)?t.filter(se).sort(ue)[0]:t[0]}(t);if(n)return vo(n),n;throw new Error("No Ad")}catch(t){throw t.code=e.VAST_NO_ADS_AFTER_WRAPPER,t}}(i.parsedXML),function(t,n){var r,o=t.ad,i=t.parsedXML,a=n.allowMultipleAds,u=void 0===a||a,c=n.followAdditionalWrappers,l=void 0===c||c;if(!de(o)&&!function(e){return Boolean(G(e||{},"Inline"))}(o))throw(r=new ro("Invalid VAST, ad contains neither Wrapper nor Inline")).code=e.VAST_SCHEMA_VALIDATION_ERROR,r;if(fe(i)&&!u)throw(r=new ro("Multiple ads are not allowed")).code=e.VAST_UNEXPECTED_MEDIA_FILE,r;if(de(o)&&!l)throw(r=new ro("To follow additional wrappers is not allowed")).code=e.VAST_UNEXPECTED_AD_TYPE,r}(i,c),de(i.ad)?(a&&u&&(u-=Date.now()-a),[2,go(pe(i.ad),mo(mo({},c),{timeout:u}),bo([i],r,!0))]):[2,bo([i],r,!0)];case 3:return p=v.sent(),o(p.code)||(p.code=e.UNKNOWN_ERROR),i.errorCode=p.code,i.error=p,null!==(h=i.response)&&void 0!==h||(i.response=p.response),[2,bo([i],r,!0)];case 4:return[2]}}))}))},Ao=go,To=function(e,t){!function(e){if(!Array.isArray(e))throw new TypeError("Invalid VAST chain");if(0===e.length)throw new Error("No next ad to request")}(e);var n=e[0],r=function(e,t){var n,r,o,i=e.ad,a=e.parsedXML,u=t.fallbackOnNoAd,c=void 0===u||u,l=t.useAdBuffet,s=void 0!==l&&l,f=ce(a).filter((function(e){return!function(e){return Boolean(e[ho])}(e)}));return fe(a)?(s&&(n=f.filter((function(e){return!se(e)}))[0]),i&&!n&&(r=f,o=(le(i)||0)+1,n=r.find((function(e){return le(e)===o})))):f.length>0&&c&&(n=f[0]),n}(n,t);if(r){var o=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([Object.assign({},n,{ad:r})],e.slice(1),!0);return vo(r),de(r)?Ao(pe(r),t,o):Promise.resolve(o)}return To(e.slice(1),t)},_o=To,Co=function(){return Co=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Co.apply(this,arguments)},Oo=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];"function"==typeof e&&e.apply(void 0,t)}},Io=function(e,t){var n=t.hooks;return"function"==typeof(null==n?void 0:n.transformVastResponse)?n.transformVastResponse(e):e},So=function(t,n,r,i){return a=void 0,u=void 0,l=function(){var a,u,c,l,s,f,d,p,h=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(r,[]);return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(this,(function(r){switch(r.label){case 0:l=h.onAdStart,s=h.onError,f=h.onRunFinish,r.label=1;case 1:return r.trys.push([1,4,,5]),"number"==typeof h.timeout&&(u=Date.now()),[4,t()];case 2:return a=r.sent(),i()?(f(),[2]):(h.timeout&&u&&(d=Date.now(),h.timeout-=d-u,u=d),function(t,n){var r;if(!t||0===t.length)throw new Error("Invalid VastChain");var o=t[0];if(!n.vpaidEnabled&&function(e){return Boolean(e[0].ad&&me(e[0].ad))}(t)){var i=new ro("VPAID ads are not supported by the current player");i.code=e.VAST_UNEXPECTED_AD_TYPE,o.errorCode=e.VAST_UNEXPECTED_AD_TYPE,o.error=i}if(o.error)throw o.error;"function"==typeof(null===(r=n.hooks)||void 0===r?void 0:r.validateVastResponse)&&n.hooks.validateVastResponse(t)}(a,h),[4,lo(Io(a,h),n,Co({},h))]);case 3:return c=r.sent(),i()?(c.cancel(),f(),[2]):(c.onError(s),c.onFinish(f),l(c),[3,5]);case 4:return function(t,n,r){var i,a=(null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.errorCode)||(null==t?void 0:t.code);n&&a&&(o(a)||(a=e.UNKNOWN_ERROR),ge(n,{errorCode:a,tracker:r}))}(p=r.sent(),a,h.tracker),s(p,{adUnit:c,vastChain:a}),!a||i()?(f(),[2]):(h.timeout&&u&&(h.timeout-=Date.now()-u),u&&h.timeout&&h.timeout<=0?(f(),[2]):(So((function(){return _o(a,h)}),n,Co({},h),i),[3,5]));case 5:return[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{o(l.next(e))}catch(e){t(e)}}function r(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof c?o:new c((function(e){e(o)}))).then(n,r)}o((l=l.apply(a,u||[])).next())}));var a,u,c,l},ko=function(e,t,n){var r,o=!1,i=Oo(n.onAdStart),a=Co(Co({vpaidEnabled:!0},n),{onAdReady:Oo(n.onAdReady),onAdStart:function(e){i(r=e)},onError:Oo(n.onError),onRunFinish:Oo(n.onRunFinish)});return n.videoElement&&n.videoElement.paused&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&n.videoElement.load(),So((function(){return Ao(e,a)}),t,a,(function(){return o})),function(){o=!0,r&&!r.isFinished()&&r.cancel()}};document.addEventListener("DOMContentLoaded",(function(){var e,t=document.querySelector("#adTag"),n=document.querySelector(".vast-test-btn"),r=document.querySelector(".vast-media video"),o=document.querySelector(".video-ad-container"),i=function(t){e=t,console.log("### onAdReady",e);var n=function(e){console.log("### ".concat(e.type),e.adUnit)};["pause","resume","finish","impression","start","skip","firstQuartile","midpoint","thirdQuartile","complete"].forEach((function(t){e.on(t,n)}))},a=function(){var e=t.value,n=r.src,a=function(){r.play(),r.removeEventListener("contentloadedmetadata",a),r.removeEventListener("canplay",a)};o.classList.add("active"),r.pause(),r.currentTime=0,console.log("### adTag",e),ko(e,o,{onAdReady:i,onError:function(e){console.log("### onError",e)},onRunFinish:function(){console.log("### onRunFinish"),o.classList.remove("active"),r.src===n?r.play():(r.addEventListener("contentloadedmetadata",a),r.addEventListener("canplay",a),r.src=n,r.load())},timeout:15e3,videoElement:r,credentials:"omit"})};t.addEventListener("change",(function(){t.value?(n.classList.add("active"),n.addEventListener("click",a)):(n.classList.remove("active"),n.removeEventListener("click",a))}))}))}(),r}()}));
//# sourceMappingURL=demo.js.map